<p><a href="..">Yukarı</a></p>
<h1>Pürüzleştirilmiş Parcaçık Hidrodinamiği (Smoothed Particle Hydrodynamics -SPH-)</h1>
<!DOCTYPE html>
<html>
  <head>
    <title>Pürüzleştirilmiş Parcaçık Hidrodinamiği (Smoothed Particle Hydrodynamics -SPH-)
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
<script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
</script>
</head>

<p>SPH sıvıların dinamik hareketini görmemizi sağlayan bir simülasyon
tekniğidir. Lagrangian bakış açısını temel alır, yani Euler aksine, bir sıvı
paketini takip edip nereye gittiğine, hangi değişimlere uğradığına
bakarız.</p>
<p>Akış dinamiğini anlatan [5]'te</p>
<p>$$
\rho \frac{D \bar{u}}{D t} = F^{toplam} 
$$</p>
<p>denklemini gördük. Bu Newton'un $F=ma$ formülasyonun bir karşılığı. Bu denklemde
basınç, ağdalık gibi kuvvetler için terimler vardı. Toplam kuvvetleri açarsak,</p>
<p>$$
F^{toplam}  = F^{\textrm{basınç}} + F^{\textrm{ağdalık}} + F^{\textrm{yerçekim}} 
$$</p>
<p>Daha detaylı hali,</p>
<p>$$
\rho \frac{D \bar{u}}{D t} = 
- \nabla p + \mu \nabla \cdot \nabla \bar{u} + \rho \bar{g}
\qquad (1)
$$</p>
<p>Simulasyon için bize ivme gerekli. Kütle ve kuvvetten ivme, oradan sayısal
entegrasyon ile yer değişimi elde edilebilir, katı-gövde simulasyonunu kodlarken
[6]'da bu anlatılmıştı. O zaman eldeki $i$'inci parçacık için toplam kuvvet
$F_i$ hesaplarsak</p>
<p>$$
a_i = \frac{\mathrm{d} u_i}{\mathrm{d} t} = \frac{F_i}{\rho_i}
$$</p>
<p>ile ivmeyi buluruz, ve oradan devam ederiz.</p>
<p>Şimdi bize gereken $\nabla p(r_i)$ ve $\nabla^2 u(r_i)$ hesaplarını yaklaşık
yapabilmemizi sağlayacak bir yaklaşım kullanmak. SPH teknikleri bunu sağlıyor.</p>
<p>Bir fonksiyon $A$ aradeğerleme (interpolation), yaklaşıklama üzerinden temsil
edilebilir [1],</p>
<p>$$
A_I(r) = \int A(r') W(r-r',h) \mathrm{d} r'
$$</p>
<p>$\bar{r}=r$ bir vektör, $\mathrm{d} r'$ diferansiyel hacim öğesi. $A_I$ aradeğerlenmiş
fonksiyon, $A$ yaklaşık göstermeye uğraştığımız fonksiyon. $A$ simulasyon
ortamında hesaplanan herhangi bir ölçüt olabilir, mesela herhangi bir
$r=(x,y,z)$ noktasındaki basınç, sıcaklık, yoğunluk, vs.</p>
<p>$W$ ağırlık fonksiyonudur, ya da çekirdek (kernel) fonksiyonu, sahip olması
gereken bir şart,</p>
<p>$$
\int_\Omega  W(r-r',h) \mathrm{d} r' = 1
$$</p>
<p>ve</p>
<p>$$
\lim_{h \to 0} W(r,h) = \delta(r)
$$</p>
<p>[4, sf. 11]. [4]'te bu tekniğin Dirac fonksiyonu ile bağlantıları
anlatıldı. Eğer $W = \delta$ dersek, yani çekirdek için Dirac fonksiyonu
kullanırsak, orijinal fonksiyonun kendisini elde ederiz.</p>
<p>Yaklaşıklamayı sıvıya uygulamak için onu kütle öğelerine bölmemiz gerekli,
$i$'inci öğe $m_i$ kütlesine, $\rho_i$ yoğunluğuna, ve $\bar{r}_i$ pozisyonuna
sahip olacak. $A$'nın $i$ parçacığındaki değeri $A_i$ ile gösterilsin. Her
parçacık için,</p>
<p>$$
A(r) = \int A(r') W(r-r',h) \mathrm{d} r'
$$</p>
<p>$$
 = \int \frac{A(r')}{\rho(r')} W(r-r',h) \rho(r') \mathrm{d} r'
$$</p>
<p>Yaklaşıklık için $A_I(r)$ da diyebilirdik, ya da $\approx$
kullanabilirdik.</p>
<p>$\rho(r')$'i hem bölen hem bölünene eklediğimiz için hiçbir değişim yaratmamış
olduk, ama böylece $\rho(r') \mathrm{d} r'$ ifadesi elde ettik ki ona parçacık kütlesi
diyebiliriz. Böylece parçacıkların kütleleri üzerinden bir toplam alabiliriz,</p>
<p>$$
A_s(r) = \sum_b m_b \frac{A_b}{\rho_b} W(r-r_b, h)
$$</p>
<p>Bu toplam teoride tüm parçacıklar üzerindendir, fakat pratikte $r$'ye yakın olan
diğer parçacıklar üzerinden alınır, çoğunlukla çekirdek $2h$ gibi bir uzaklıkta
zaten hızla sıfıra düştüğü için, ayrıca performans açısından, çok uzaktaki
parçacıkları göz önüne almaya gerek yoktur.</p>
<p>Üstteki formül bana herhangi bir $r$ noktasında hesaplayabileceğim bir kestirme
hesap (estimation) vermiş oldu. Parcaçık bazlı simülasyon yaptığımız için her
$i$ parçacığı çevresindeki $j$ parçacıkları üzerinden bu kestirme hesabı
yapabileceğiz.</p>
<p>Aradeğerlemenin bize sağladığı güzel bir özellik onun üzerinden mesela gradyan
alabilmem. Diyelim ki $A$ ölçümü basınç, yani $p$. O zaman (1)'de görülen
$-\nabla p$ formülünü üstteki entegral üzerinden açabilmem gerekir. $r$'de olan
her $i$ parçacığı için $p(r_i)$ diyelim,</p>
<p>$$
p(r_i) = \sum_j \frac{m_j p_j}{\rho_j} W(r_i-r_j,h)
$$</p>
<p>Bu denklemin gradyanını alabiliriz şimdi,</p>
<p>$$
\nabla p(r_i) = \sum \frac{m_j p_j}{\rho_j} \nabla W(r_i-r_j,h)
$$</p>
<p>Gradyan direk $W$ üzerinde uygulanmış oldu. Burada modellemeyi yapan kişi tabii
ki $W$'yi "gradyanı rahat alınan" fonksiyonlar arasından da seçecektir,
böylece işler daha da kolaylaşacaktır.</p>
<p>O zaman üstteki sonuç ile $-\nabla p$ yazarsak,</p>
<p>$$
F_i^{\textrm{basınç}} = - \sum_j \frac{m_j p_j}{\rho_j} \nabla W(r_i-r_j,h)
$$</p>
<p>elde ederiz.</p>
<p>Fakat burada bir problem var, $j$ bölgesindeki basıncı kullanarak o fark
üzerinden $i$ üzerindeki kuvveti hesapladık, fakat basınç farkı dolayısıyla
$i$'nin $j$ üzerinde uyguladığı kuvvet aynı olmayabilir. Yani kuvvet simetrik
olmaz, fakat fizik kanunlarına göre etki-tepki aynı olmalıdır. Simülasyon
amacıyla çoğunlukla yapılan dışarıdan müdahele ile kuvveti simetrik hale
getirmektir, mesela bir yöntem basit aritmetik ortalama almak,</p>
<p>$$
F_i^{\textrm{basınç}} = - \nabla p(r_i) =
- \sum_j m_j \frac{p_i + p_j}{2 \rho_j} \nabla W(r_i-r_j,h)
$$</p>
<p>[devam edecek]</p>
<p>Kaynaklar</p>
<p>[1] Monaghan, <em>Smoothed particle hydrodynamics, 2005</em></p>
<p>[2] Schuermann, <em>Particle-Based Fluid Simulation with SPH</em>,
    <a href="https://lucasschuermann.com/writing/particle-based-fluid-simulation">https://lucasschuermann.com/writing/particle-based-fluid-simulation</a></p>
<p>[3] Bayramlı, <em>Hesapsal Bilim, Ders 4</em></p>
<p>[4] Kelager, <em>Lagrangian Fluid Dynamics Using Smoothed Particle Hydrodynamics</em></p>
<p>[5] Bayramlı, <em>Fizik, Akış Dinamiği</em></p>
<p>[6] Bayramlı, <em>Fizik, Simulasyon</em></p>
<p>[7] Monaghan, <em>Introduction to SPH Part I</em>,
    <a href="https://www.youtu.be/tAXHCAEgSuE">https://www.youtu.be/tAXHCAEgSuE</a></p>