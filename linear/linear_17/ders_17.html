<!DOCTYPE html>
<html>
  <head>
    <title>Ders 17
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
   <script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
   </script>
   <link rel="stylesheet" type="text/css" media="screen" href="https://burakbayramli.github.io/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1548953794786292"
          crossorigin="anonymous"></script>  
  </head>
    <body>
      <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">
            <a href="https://burakbayramli.github.io" style="text-decoration:none; color:inherit;">dersblog</a>
          </h1>
          <h2 id="project_tagline"></h2>          
        </header>
      </div>
      <div id="main_content_wrap" class="outer">        
        <section id="main_content" class="inner">
        <h1>Ders 17
</h1>

<p>Bugün dikgenlik (orthogonality) ders dizisinin sonuncusundayız. Dikgen
vektörleri, iki tanesini gördük, dikgen altuzayları gördük, ki bunlar satır
uzayı ve sıfır uzayı idi, bugün dikgen baz ve dikgen matrisi göreceğiz.</p>
<p>Şimdi birimdik (orthonormal) kelimesinden bahsetmek istiyorum. Bu arada bu
derste $q$ harfini dikgen vektörleri temsil etmek için kullanacağım.</p>
<p>Birimdik vektörler </p>
<p>$$
q_i^Tq_j = \left\{ \begin{array}{lll}
0 &amp; \textrm{eğer} &amp; i \ne j \textrm{ ise}\\
1 &amp; \textrm{eğer} &amp; i = j \textrm{ ise}
\end{array} \right.
$$</p>
<p>Yani $q$ vektörleri diğer her $q$'ya (kendisi haricinde) dikgen. Her biri
bir diğerine 90 derece dik vektörlerden oluşan bir baz olması doğal bir
şey. $q$ vektörleri birim, bu sebeple kendisiyle noktasal çarpımı
1. Birimdik kelimesinin İngilizcesi orthonormal'ın içindeki "normal"
buradan geliyor, normalize edilmiş vektörlerimiz var.</p>
<p>Birimdik baza sahip olmak hesapları basitleştirir, çoğu hesabı iyileştirir,
sayısal lineer cebirin çoğunluğu birimdik vektörlerle iş yapmak etrafında
kurulmuştur, çünkü onlar aşırı büyümezler, aşırı küçülmezler, kontrol
altında iş yapmak mümkün olur.</p>
<p>Bu $q$'leri $Q$ içine koyacağız. Dersin ikinci kısmında eğer birimdik
olmayan bir $A$ matrisim var ise, onu nasıl birimdik yaparım, onu
göreceğiz. Şimdi üstteki 1 ve 0 içeren formülü matris olarak yazmak
istiyorum.</p>
<p>$$
Q = 
\left[\begin{array}{rrr}
\uparrow &amp;  &amp; \uparrow \\
q_1 &amp; ... &amp;  q_n \\
\downarrow &amp;  &amp; \downarrow 
\end{array}\right]
$$</p>
<p>O zaman </p>
<p>$$
Q^TQ = 
\left[\begin{array}{rrr}
\leftarrow &amp; q_1^T &amp; \rightarrow \\
&amp; &amp;  \\
\leftarrow &amp; q_n^T &amp; \rightarrow 
\end{array}\right]
\left[\begin{array}{rrr}
\uparrow &amp;  &amp; \uparrow \\
q_1 &amp; ... &amp;  q_n \\
\downarrow &amp;  &amp; \downarrow 
\end{array}\right] = 
I
$$</p>
<p>Eğer $Q$ kare ise, $Q^TQ = I$  bize $Q^T = Q^{-1}$ olduğunu söyler. </p>
<p>Örnek </p>
<p>Her permutasyon matrisi </p>
<p>$$
Q = 
\left[\begin{array}{rrr}
0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 
\end{array}\right]
$$</p>
<p>kendi devriği ile çarpılınca, yani </p>
<p>$$
Q^T = 
\left[\begin{array}{rrr}
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
1 &amp; 0 &amp; 0 
\end{array}\right]
$$</p>
<p>ile, sonuç $I$ olacaktır. Bir diğer örnek </p>
<p>$$Q = 
\left[\begin{array}{cc}
\cos \theta &amp; -\sin \theta \\
\sin \theta &amp; \cos \theta \\
\end{array}\right]
$$</p>
<p>Fakat şu matris,</p>
<p>$$Q = 
\left[\begin{array}{cc}
1 &amp; 1 \\
1 &amp; -1 \\
\end{array}\right]
$$</p>
<p>dikgen matris değildir (şimdilik). Her kolonun uzunluğu $\sqrt{2}$, o
zaman tüm matrisi $\sqrt{2}$ ile bölerim,</p>
<p>$$Q = \frac{1}{\sqrt{2}}
\left[\begin{array}{cc}
1 &amp; 1 \\
1 &amp; -1 \\
\end{array}\right]
$$</p>
<p>Örnek </p>
<p>$$Q = \frac{ 1}{2}
\left[\begin{array}{rrrr}
1 &amp; 1&amp; 1&amp; 1 \\
1 &amp; -1&amp; 1&amp; -1 \\
1 &amp; 1&amp; -1&amp; -1 \\
1 &amp; -1&amp; -1&amp; 1 
\end{array}\right]
$$</p>
<p>Örnek </p>
<p>$$Q = \frac{ 1}{3}
\left[\begin{array}{rr}
1 &amp; -2 \\
2 &amp; -1 \\
2 &amp; 2 
\end{array}\right]
$$</p>
<p>Bir kolon daha eklersem </p>
<p>$$Q = \frac{ 1}{3}
\left[\begin{array}{rrr}
1 &amp; -2 &amp; 2\\
2 &amp; -1 &amp; -2 \\
2 &amp; 2 &amp; 1
\end{array}\right]
$$</p>
<p>Birimdik vektörler ve özelde Gram-Schmidt ile uğraşırken göreceğiz,
sürekli normal vektörlerle uğraştığımız için sürekli uzunluğa bölmeniz
gerekir, ve bu sürekli bir karekökü hesabın içine çeker. Üstteki örnek
temiz, karekök direk sayı olarak elde edildi. </p>
<p>Dikgen matrisler niye iyidir? Onlar hangi hesapları basitleştirirler?
$Q$ ne için kullanılır? </p>
<p>Diyelim ki bir diğer matrisi alıp $Q$'nun kolon uzayına yansıtmak
(projection) istiyorum. Yansıtma formülünü, matrisi $Q$ için yazarsak,</p>
<p>$$P = Q (Q^TQ)^{-1}Q^T$$</p>
<p>Formülde $Q$ olmasının bir avantajı, $Q^TQ = I$, o zaman </p>
<p>$$P = Q Q^T$$</p>
<p>Bu yansıtma matrisinin özelliklerini / öğelerini (properties) kontrol
edelim. İki tane özellik olması gerekiyor. Eğer kolonlar birimdik ise, ve
yansıtma matrisi kare ise, o zaman kolon uzayı nedir? Tüm uzaydır!
Birimdik kolonlar o uzayı yaratmak / kapsamak (span) için
yeterlidir. Bu uzaydaki her türlü vektörü bu birimdik vektörlerin bir
kombinasyonu üzerinen üretebilirsiniz. Peki, tüm uzaya yansıtmak ne
demektir? Nasıl bir $P$ tüm uzaya yansıtır? Birim (identity) matrisi. Tüm
uzaya yansıtmak hiçbir şeyi değiştirmemek demektir aslında, ve bu
değişmezliği yapacak tek yansıtma matrisi $I$. </p>
<p>$$P = Q Q^T = I \textit{ eğer I kare ise }$$</p>
<p>Bir diğer özellik yansıtma matrislerinin simetrik olması. Devriği ile
sağdan çarpılmak bir matrisi zaten simetrik yapar, şart $QQ^T$ için
geçerlidir. Bu özelliğin sebebi yansıtıp, sonra tekrar yansıtınca, ikinci
yansıtmanın değişim yaratmaması. Yani </p>
<p>$$(QQ^T)(QQ^T) = QQ^T$$</p>
<p>olmalı. Kontrol edelim,</p>
<p>$$Q(Q^TQ)Q^T = QIQ^T = QQ^T$$</p>
<p>$Q$'nun özellikleri bize şu şekilde de yarar. Normal formül nedir? </p>
<p>$$A^TA\hat{x} = A^Tb$$</p>
<p>$A$ yerine $Q$ ise</p>
<p>$$Q^TQ\hat{x} = Q^Tb$$</p>
<p>$Q^TQ = I$ olduğuna göre, </p>
<p>$$\hat{x} = Q^Tb$$</p>
<p>İşler iyice basitleşti yani. $A$'li versiyonda sol taraftaki iç çarpımları
(inner product) hesaplamak gerekecekti, cebirsel çözüm için uğraşılacaktı,
vs. Bunlar $Q$ ile yok. $\hat{x}$'in $i$'inci elemanı $q_i^Tb$, yani </p>
<p>$$\hat{x}_i = q_i^Tb$$</p>
<p>Üstteki formülün matematiğin en önemli formüllerinden biri olduğu
söylenebilir. Yani elimizde birimdik baz var ise, yansımasının $i$'inci
öğesi yukarıdaki gibidir. </p>
<p>Şimdi dersin ikinci bölümüne gelelim. Diyelim ki elimizde birimdik matris
yok, bağımsız vektörler var, onları birimdik yapacağız. Gram-Schmidt
burada ortaya çıkıyor. Tabii "birimdik yapmak" nedir, onu da
açıklayalım. Eğer vektör $a,b$ bağımsız vektörleri birbirine dik değilse,
onları değişime uğratmadan dik hale getiremeyiz. Birimdikleştirme işlemi
vektörleri "eski haline mümkün olduğunca yakın kalmak suretiyle"
dikleştirir ve normalleştirir. </p>
<p>Gram-Schmidt</p>
<p>GS hesabı eliminasyon ile aynı şey değildir, amacımız üçgensel değil,
amacımız bir matrisi dikgen, kolonlarını birimdik yapmak. İki
vektörümüz var diyelim, $a,b$. Belki 12 boyutlu bir ortamdalar, belki
(alttaki gibi) 2 boyuttalar. Vektörler bağımsız. </p>
<p><img alt="" src="17_1.png" /></p>
<p>Bu iki vektörden $q_1,q_2$ birimdik vektörlerini çıkartmak istiyorum. Ya
da, önce dikgen $A,B$, sonra birimdik $q_1,q_2$ diyelim. Bunun için önce</p>
<p>$$q_1 = \frac{ A}{||A||}, q_2 = \frac{ B}{||B||} $$</p>
<p>Aslında $a$'dan $A$ alınca, o vektörün işi bitmiş kabul edilebilir. Bir yön
tamam, ama ilk yön olduğu için onun dikgen hali yeterli. Şimdi ikinci
vektör nasıl birimdik olacak, çünkü artık birinciye göre dik olmalı, onu
olduğu gibi alamayız. </p>
<p><img alt="" src="17_2.png" /></p>
<p>Aradığımız vektör $b$'nin $a$'ya yansıması değil, ona tam dik olan
$e$. Eğer $b$'nin formülü "$b$'nin $a$'ya yansıması, artı $e$" ise, o
zaman ters yöne gitmek için çıkartma işlemini kullanırız,</p>
<p>$$B = b - [yansıma]$$</p>
<p>$b$'nin $a$'ya yansıması nedir? Yerine koyalım,</p>
<p>$$B = b - \frac{ A^Tb}{A^TA}A$$</p>
<p>Bu formül doğru mu? Kontrol edelim, eğer $B$ hakikaten $A$'ya dikgen bir
vektör veriyorsa, o zaman $A^T$ ile çarpılınca sıfır elde etmeliyiz. </p>
<p>$$A^TB = A^T(b - \frac{ A^Tb}{A^TA}A)$$</p>
<p>$$= A^Tb - \frac{ A^Tb}{A^TA}A^TA$$</p>
<p>$$= A^Tb - A^Tb = 0$$</p>
<p>Peki ya iki değil üç tane vektör olsaydı? Yani $A,B$'ye ek olarak bir de
$C$ hesaplamamız gerekiyor. </p>
<p><img alt="" src="17_3.png" /></p>
<p>Bu hesaba şu şekilde bakabiliriz, aynen $B$'yi bulmak için $b$'den $a$ yönünde
olan yansımasının kısmını çıkarttığımız gibi, $C$'yi bulmak için $c$'den $a$ ve
$b$ yönünde olan yansımasının kısımlarını çıkartmayı düşünebiliriz.</p>
<p>$$C = c - \frac{ A^Tc}{A^TA}A - \frac{ B^Tc}{B^TB}B$$</p>
<p>Yani $C \perp A$, $C \perp B$. </p>
<p>Örnek</p>
<p>$$
a = 
\left[\begin{array}{r}
1 \\ 1 \\ 1
\end{array}\right],
b = 
\left[\begin{array}{r}
1 \\ 0 \\ 2
\end{array}\right]
$$</p>
<p>Hemen $A = a$ deriz. $B$ nedir?</p>
<p>$$
B = 
\underbrace{
\left[\begin{array}{r}
1 \\ 0 \\ 2
\end{array}\right]}<em>{b}
-
\frac{ 3}{3}
\underbrace{
\left[\begin{array}{r}
1 \\ 1 \\ 1
\end{array}\right]}</em>{A}
=
\left[\begin{array}{r}
0 \\ -1 \\ 1
\end{array}\right]
$$</p>
<p>$Q$'yu oluşturalım. Unutmayalım, her $q$ birim vektör, normalize
olmalı. Problem değil, değerleri üstten alırken her elemanı uzunluğuna
böleriz, </p>
<p>$$Q =
\left[\begin{array}{rrr}
\uparrow &amp;  &amp; \uparrow \\
q_1 &amp; ... &amp;  q_n \\
\downarrow &amp;  &amp; \downarrow 
\end{array}\right]
=
\left[\begin{array}{rr}
1/\sqrt{3} &amp; 0 \\
1/\sqrt{3} &amp; -1/\sqrt{2} \\
1/\sqrt{3} &amp; 1/\sqrt{2} 
\end{array}\right]
$$</p>
<p>Hatırlarsak ilk halimiz</p>
<p>$$A =
\left[\begin{array}{rr}
1 &amp; 1 \\
1 &amp; 0\\
1 &amp; 2
\end{array}\right]
$$</p>
<p>şeklindeydi. </p>
<p>$Q$'nun kolon uzayı ile $A$'nin kolon uzayı arasındaki bağlantı, fark
nedir? Kolon uzayı bir matrisin kolonlarının tüm kombinasyonları ise, 3
boyutlu uzayda iki kolonum var, demek ki kolon uzayı bir düzlem (plane),
her iki matris için durum bu. Alaka nerede? İki düzlem de aynı! Tek
yaptığım aynı uzayı yaratan ama birbirine dik iki yeni vektör yaratmak
oldu. $Q$ vektörlerinden daha memnunum çünkü $Q$ birimdik. </p>
<p>Peki Gram-Schmidt'i Lineer Cebir dilinde nasıl daha temiz sekilde
gösteririm? Eliminasyon mesela </p>
<p>$$A = LU$$</p>
<p>olarak gösterilir. Gram-Schmidt'in karşılığı nedir? Şudur,</p>
<p>$$A = QR$$</p>
<p>$$
\left[\begin{array}{rrr}
\uparrow &amp;  \uparrow \\
a_1 &amp;  a_2 \\
\downarrow &amp;  \downarrow 
\end{array}\right]
=
\left[\begin{array}{rrr}
\uparrow &amp;  \uparrow \\
q_1 &amp;  q_2 \\
\downarrow &amp;  \downarrow 
\end{array}\right]
\left[\begin{array}{rrr}
 &amp;   \\
0 &amp;<br />
\end{array}\right]
$$</p>
<p>Yani $R$ üst üçgensel (lower triangular) bir matristir, sol alt köşe
sıfırdır. Niye? </p>
<p>$$
= \left[
\begin{array}{rrr}
\uparrow &amp;  \uparrow \\
q_1 &amp;  q_2 \\
\downarrow &amp;  \downarrow 
\end{array}\right]
\left[\begin{array}{rrr}
a_1^Tq_1 &amp;  * \\
a_1^Tq_2 &amp;  *
\end{array}
\right]
$$</p>
<p>Sıfır $a_1^Tq_1$'dan geliyor. Özetlemek gerekirse, $A$'yi alıp $Q$'yu elde
ediyoruz, ve bu iki matris arasındaki ilişki üst üçgensel olan $R$
matrisi. </p>
<p>Gram-Schmidt Python kodu altta bulunabilir.</p>
<pre><code class="python">import numpy.linalg as lin

A = np.array([[3., 4.],[5., 6.]])
m,n = A.shape
R = np.zeros((m,n))
Q = np.zeros((m,n))

for j in range(n):
    v = A[:,j]
    for i in range(j):
        R[i,j] = np.dot(Q[:,i].T,A[:,j])
        v=v-np.dot(R[i,j],Q[:,i])
    R[j,j] = lin.norm(v)
    Q[:,j] = v/R[j,j]
print Q, R
</code></pre>

<pre><code>[[ 0.51449576  0.85749293]
 [ 0.85749293 -0.51449576]] [[ 5.83095189  7.20294058]
 [ 0.          0.34299717]]
</code></pre>
        </section>          
      </div>
    </body>
</html>
