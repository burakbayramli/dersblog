
<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
   <script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
   </script>
   <link rel="stylesheet" type="text/css" media="screen" href="https://burakbayramli.github.io/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1548953794786292"
          crossorigin="anonymous"></script>  
  </head>
    <body>
      <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">
            <a href="https://burakbayramli.github.io" style="text-decoration:none; color:inherit;">dersblog</a>
          </h1>
          <h2 id="project_tagline"></h2>          
        </header>
      </div>
      <div id="main_content_wrap" class="outer">        
        <section id="main_content" class="inner">
        <h1></h1>
<h1>Pandas ile Birlesim (Join)</h1>

<p>Iki cetrefil SQL'in urettigi sonuclarin bir adres kodu (zip) kolonu
uzerinden birlestirilmesi gerekiyordu, ve sartlar oyledir ki Web
sitemizin surekli kullandigi tabanin bir kopyasi olan
sadece-okunabilir (read-only) tabana (dogal olarak) yazim yetkisi
mevcut degildi. Sonuclar nasil birlestirilebilir?</p>

<p>Iki SQL'in ciktisi CSV olarak alinir. Sonra bu ciktilar ayri ayri
Pandas ile DataFrame olarak yuklenir. Pandas'in DataFrame'leri hafiza
icinde sanki tabloymus gibi birlestirebilme (join) ozelligi vardir!
Kod altta. Not olarak duselim, Pandas ve Numpy oldukca buyuk csv
dosyalarini hafizada cok hizli isleyebilir. Bizim durumumuzda 100 MB
buyuklugunde ciktilar vardi, ve Pandas hizla birlesimi gerceklestirdi.</p>

<pre><code>import numpy as np
from pandas import *

csv1 = read_csv("dosya1.csv")
csv2 = read_csv("dosya2.csv")
res =  merge(csv1, csv2, left_on='plz', right_on='zip', how='inner')
res.to_csv("sonuc.csv",  sep='\t')
</code></pre>

        </section>          
      </div>
    </body>
</html>
