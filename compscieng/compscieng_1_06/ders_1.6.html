<!DOCTYPE html>
<html>
  <head>
    <title>Ders 1.6
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
   <script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
   </script>
   <link rel="stylesheet" type="text/css" media="screen" href="https://burakbayramli.github.io/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1548953794786292"
          crossorigin="anonymous"></script>  
  </head>
    <body>
      <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">
            <a href="https://burakbayramli.github.io" style="text-decoration:none; color:inherit;">dersblog</a>
          </h1>
          <h2 id="project_tagline"></h2>          
        </header>
      </div>
      <div id="main_content_wrap" class="outer">        
        <section id="main_content" class="inner">
        <h1>Ders 1.6
</h1>

<p>Özvektör formülüne tekrar bakalım</p>
<p>$$ Ay = \lambda y $$</p>
<p>Şimdi tüm özvektörler aynı anda tek bir matris içinde olacak şekilde
üstteki formülün her özvektör için işleyecek "kombine" bir halini
yazabiliriz. $y_i$ vektörünün tüm bir kolonu kaplayacak şekilde matrise
yazıldığını düşünüyoruz. </p>
<p>$$ 
A 
\left[\begin{array}{cccc}
\uparrow &amp; \uparrow &amp;  &amp; \uparrow \\
y_1 &amp; y_2 &amp; ... &amp; y_n \\
\downarrow &amp; \downarrow &amp;  &amp; \downarrow 
\end{array}\right]
= 
\left[\begin{array}{cccc}
&amp;&amp;&amp; \\
Ay_1 &amp; Ay_2 &amp; ... &amp; Ay_n \\
&amp;&amp;&amp; 
\end{array}\right]
$$</p>
<p>Buna göre üstteki eşitliğin sağındaki çarpım da mantıklıdır.Peki $Ay_i$
çarpımı tanıdık gelmiyor mu? Çarpım özvektör, özdeğer formülü. O zaman
$Ay_i = \lambda y_i$. Demek ki,</p>
<p>$$ 
\left[\begin{array}{cccc}
&amp;&amp;&amp; \\
Ay_1 &amp; Ay_2 &amp; ... &amp; Ay_n \\
&amp;&amp;&amp; 
\end{array}\right]
= 
\left[\begin{array}{cccc}
&amp;&amp;&amp; \\
\lambda_1y_1 &amp; \lambda_2y_2 &amp; ... &amp; \lambda_ny_n \\
&amp;&amp;&amp; 
\end{array}\right]
 $$</p>
<p>$\lambda$'ları dışarı çekebiliriz. </p>
<p>$$ 
= \left[\begin{array}{cccc}
&amp;&amp;&amp; \\
y_1 &amp; y_2 &amp; ... &amp; y_n \\
&amp;&amp;&amp; 
\end{array}\right]
\left[\begin{array}{cccc}
\lambda_1 &amp;&amp;&amp; \\
&amp; .. &amp;&amp; \\
&amp;&amp;&amp; \lambda_n \\
\end{array}\right]
 $$</p>
<p>$\lambda$ matrisinde $\lambda$ olmayan yerler sıfır değerini
taşıyor. Özvektör matrisini $S$ olarak, çaprazında özdeğerleri taşıyan
matrisi $\Lambda$ olarak nitelersek</p>
<p>$$ AS = S\Lambda $$</p>
<p>Eğer üstteki $S$ (ya da herhangi bir) matrisinin tüm kolonları birbirinden
bağımsız ise $S$ tersine çevirelebilir (invertible) demektir. O zaman şunu
yapabiliriz:</p>
<p>$$ A = S \Lambda S^{-1} $$</p>
<p>Bu forma matrisin köşegenleştirilmesi (diagonalization) deniyor. </p>
<p>Biraz zihin egzersizi: $A^2$ ne olur? </p>
<p>$$ A^2 = (S \Lambda S^{-1})(S \Lambda S^{-1}) $$</p>
<p>$$ = S \Lambda S^{-1}S \Lambda S^{-1} $$</p>
<p>ortadaki $S$ ve $S^{-1}$ birbirini iptal eder. </p>
<p>$$ = S \Lambda^2 S^{-1} $$</p>
<p>Bu bana ne söylüyor? $A^2$'nin özvektörleri $A$ ile aynı, çünkü formülün
$S$ ve $S^{-1}$ içeren kısmı değişmedi, özdeğerler ise $A$'nin
özdeğerlerinin karesi. Bu önceden bulduğumuz $A^2y = \lambda^2y$ sonucu 
ile uyuşuyor.</p>
<p>Peki, diyelim tersine çevirilebilir ise, $A^{-1}$ nedir? Ana formülden 
başlayalım</p>
<p>$$ A = S \Lambda S^{-1} $$</p>
<p>Tersine çevirme işlemi eşitliğin sağ tarafında parantezin içinin sırasını
değiştirir, sonra tersine çevirir, $S^{-1}$ ile başlarız, onun tersi $S$,
vs, ve sonuç</p>
<p>$$ A^{-1} = S \Lambda^{-1}S^{-1} $$</p>
<p>Özvektörler matrislerinin yeri ve içeriği değişmedi. Değişik olan tek şey
$\Lambda^{-1}$ ki bu matris içinde $1/\lambda_1$, $1/\lambda_2$, .. gibi
değerler olacak. Diğer bir açıdan kontrol edelim:</p>
<p>$$ Ay = \lambda y $$</p>
<p>$$ y = \lambda A^{-1} y $$</p>
<p>$$ \frac{1}{\lambda}y =  A^{-1} y $$</p>
<p>Bu üstteki sonuç ile aynı şeyi söylüyor. $A^{-1}$'in tersi aynı $y$
özvektör(ler)e sahip, ve solda olan özdeğer öncekine kıyasla $1/\lambda$
değerinde. </p>
<p>Tabii tüm bunlara başlamadan önce "$\lambda$'nin sıfır olmadığı
durumlarda" demeliydim, çünkü bu sıfırlık durum bize $A$'nin tersine
çevirilir olmadığı yönünde bir işaret olurdu. Terminoloji olarak bir tane
bile sıfır özdeğer $A$ eşsiz (singular) demektir, eğer hiçbiri sıfır
değilse $A$ tersine çevirilebilir demektir.</p>
<p>Bir simetrik $K$ matrisini ele alalım, simetrik olduğu için tüm özdeğerleri
reel sayılar, ve özvektörleri birbirine dikgen (orthagonal). </p>
<p>Dik yerine normalize edilmiş de diyebilirdik, sayısal paketler çoğunlukla
birimselleştirilmiş, yani uzunluğu 1 olan vektörler döndürür, ve
özdeğer/vektör ikilisi için zaten yön önemlidir, hem özdeğer hem özvektörü
2 ile çarpıp aynı şeyi elde edebiliriz mesela.</p>
<p>Uzunluktan bahsederken, onu daha önce $y_i^T \cdot y_j$ olarak gösterdik,
ki simetrik bir matrisin dik özdeğerleri için bu $y_i^T \cdot y_j = 0, \ i
\ne j$. Normalize edilmiş bir özvektörün kendisi ile noktasal çarpımı nedir? 
$y_i^T \cdot y_i = 1$ çünkü vektör birimsel, uzunluğu 1. Tüm
özdeğerleri içeren matris üzerinden bu hesabı yapabilir miyiz? Daha önce
yarattığımız şu matris ile başlayalım:</p>
<p>$$ 
\left[\begin{array}{cccc}
\uparrow &amp; \uparrow &amp;  &amp; \uparrow \\
y_1 &amp; y_2 &amp; ... &amp; y_n \\
\downarrow &amp; \downarrow &amp;  &amp; \downarrow 
\end{array}\right]
$$</p>
<p>sol tarafına devriğini (transpose) koyalım</p>
<p>$$ 
\left[\begin{array}{ccc}
\leftarrow &amp; y_1^T &amp; \rightarrow \\
 &amp; ... &amp; \\
\leftarrow &amp; y_n^T &amp; \rightarrow 
\end{array}\right]
\left[\begin{array}{cccc}
\uparrow &amp; \uparrow &amp;  &amp; \uparrow \\
y_1 &amp; y_2 &amp; ... &amp; y_n \\
\downarrow &amp; \downarrow &amp;  &amp; \downarrow 
\end{array}\right]
$$</p>
<p>Bu çarpımı yaparsak sonuç ne olacak? Mesela $y_1^T$ ile $y_1$ çarpımı 1
değerinde, $y_1^T$ ile diğer her çarpım sıfır. Böyle gider. Ve sonuç olarak
çaprazında 1 diğer her yerinde 0 içeren birim (identity) matrisini elde
ederiz.</p>
<p>Üzerine basarak söyleyelim, bu simetrik matrisler için, çünkü diğer $A$
matrisleri için özvektörlerin hepsinin birbirine dik olmasını
bekleyemeyiz. </p>
<p>Devam edelim, o zaman üstteki hesabı kısaca gösterirsek</p>
<p>$$ S^T S = I $$</p>
<p>Bu hakikaten çok önemli bir sonuç. </p>
<p>Üsttekinin doğru olduğu durumlarda $S$ harfini değiştirirsek aslında daha iyi
olur böylece özvektör matrisinin bir simetrik $K$ matrisinden geldiğini
daha iyi görürüz. Bu durumlarda $Q$ harfini kullanalım. </p>
<p>$Q$'ye bir "dik matris" te denebilir, çünkü $Q^TQ = I$. Bu ifadeye
bakarak başka bir şey daha söyleyebiliriz, $Q$'yu başka <em>ne</em> soldan
çarparsa sonuç birim matristir? $Q^{-1}$. O zaman $Q^T = Q^{-1}$ de
diyebiliriz.</p>
<p>Bir dik matris örneği görelim:</p>
<p>$$ 
\left[\begin{array}{cc}
\cos \theta &amp; -\sin \theta \\
\sin \theta &amp; \cos \theta \\
\end{array}\right]
 $$</p>
<p>İlk kolona bakalım, uzunluğu hakikaten 1, çünkü $\cos \theta ^2 + \sin \theta
^2 = 1$. Diğer kolon da ona dik, 1. kolon ile çarpılınca sonuç sıfır olacak. </p>
<p>Not: Üstteki matrise "$\theta$ kadar döndüren matris" ismi de verilir,
eldeki bir $v$ vektörünü $Q$ ile çarpımı, yani $Qv$, o vektörü uzunluğunu
değiştirmeden $\theta$ kadar döndürecektir.</p>
<p>Devam edelim</p>
<p>$$ K = S \Lambda S^{-1} $$</p>
<p>$S$ yerine $Q$ kullanmaya karar vermiştik</p>
<p>$$  K = Q \Lambda Q^{-1} $$</p>
<p>O zaman, daha önceden gördüğümüz eşitlik üzerinden, </p>
<p>$$  K = Q \Lambda Q^{T} $$</p>
<p>Şu güzelliğe bakın. Buna mekanikte asal eksen teoremi (principal axis theorem),
matematikte spektral teoremi (spectral theorem), kuantum mekanikte
köşegenleştirme (diagonalization) ismi verilir, her yerde ortaya çıkar, pek çok
şekilde kullanılır. Ne zaman elde bir simetrik matris var ise, o zaman üstteki
tanım kullanılabilir demektir.</p>
<p>$K$ matrisine geri dönelim. </p>
<p>$$ 
K =
\left[\begin{array}{rrrrr}
2 &amp; -1 &amp;&amp;&amp; \\
-1 &amp; \ddots &amp; \ddots &amp;&amp; \\
&amp; \ddots &amp;&amp;&amp; \\
&amp;&amp;&amp;&amp; \\
&amp;&amp;&amp;&amp; 
\end{array}\right]
 $$</p>
<p>Bu matris ikinci farklılıkları ayrıksal olarak temsil etmek için
kullanılmıştı, esnek çubuğu temsil ettiği zaman sabit / sabit problemini
çözüyordu. $K$ sürekli (continuous) bağlamda hangi diferansiyel
denklemi temsil edecektir? $-d^2y/dx^2$.  Özdeğer, özvektör olarak ise</p>
<p>$$ Ky = \lambda y $$</p>
<p>Şöyle bir geçiş yapılabilir</p>
<p>$$ -\frac{d^2y}{dx^2} = \lambda y(x) $$</p>
<p>Burada ilginç bir numara var: daha önce sürekli fonksiyondan başlıyorduk,
sonra $K$ matrisi üzerinden ayrıksal hale geçiriyorduk. Hoca burada
özdeğer, özvektör formundan başladı, ve sürekli forma geçti. Sonra üstteki
denklemin çözümünü bulunca, tekrar geri gidecek, ve ayrıksal olarak
özvektörlerin birbirine dikliğini göreceğiz, ve bunun sürekli bağlamda da
hala geçerli olduğunu anlayacağız. </p>
<p>Çözümü bulmak için tahmin yöntemini kullanalım: hangi fonksiyonun ikinci
türevinin negatifi, o fonksiyonun katını verir? Sin ve cos fonksiyonları,
yani $y$ $\sin \omega x$, $\cos \omega x$ olabilir, ya da onların birleşimi
olarak üstel $e^{-i\omega x}$, $e^{i\omega x}$ formunda olabilir.</p>
<p>Eğer $y$ için $\sin, \cos$ kullanırsak özdeğer ne olur? Yerine koyarsak
görürüz, $\sin\omega x$'in iki kere türevini alırsak $\omega$ iki kere
dışarı çıkar, arada bir eksi değeri mutlaka ortaya çıkar (çünkü 
$\cos'\theta = -\sin\theta)$, eksi ile eksi çarpılır, sonuç $\omega^2$. 
Hatta üstteki tüm $y$ seçenekleri için sonuç aynıdır. </p>
<p>Sınır koşullarını unutmayalım tabii. Problemin tamamı</p>
<p>$$ -\frac{d^2y}{dx^2} = \lambda y(x) $$</p>
<p>$$ y(0) = 0, \ y(1) = 0 $$</p>
<p>Sınır koşulları sayesinde tüm $\sin$, tüm $\cos$ fonksiyonları arasından belli
bazılarını seçebileceğiz. En basit eleme $y(0) = 0$, bu şart sayesinde cos
fonksiyonlarının tamamı elenir. Değil mi? Çünkü $\cos(0) = 0$ doğru
olamaz. Diğer şarta bakalım, $y(1)$ üzerinden $\sin(\omega) = 0$ olur,
tersinden düşünürsek $\sin(\omega)$ ile sıfır değeri verecek $\omega$ ne
olabilir? $\pi$ olabilir. O zaman bir çözüm bulduk:</p>
<p>$$ y_1 = \sin \pi x $$</p>
<p>Elimizdeki ilk "özfonksiyon (eigenfunction)" bu. Özdeğeri nedir?</p>
<p>$$ \lambda_1 = \pi^2 $$</p>
<p>çünkü üstte belirttik, $\omega^2$, o zaman $\pi^2$. </p>
<p>İkinci değer ne olur? $2\pi$. </p>
<p>$$ y_2 = sin2\pi x, \ \lambda_2 = (2\pi)^2 = 4\pi^2 $$</p>
<p>Eğer sınır şartlarını değiştirseydim, serbest / serbest, serbest / sabit
gibi, o zaman farklı $y$ değerleri elde ederdim. Mesela ilk sınır şartı
$y'(0) = 0$ olsaydı, sin fonksiyonları yerine cos fonksiyonları elde
ederdik, sin elenirdi çünkü sin'in türevi $\cos(0) = 0$ doğru bir ifade
olamazdı. </p>
<p>Ayrıksal olarak temsil edersek, $\sin\pi h$ ve $h = 1 / n+1$, $n = 4$
kullanalım</p>
<p>$$ 
y_1 = 
\left[\begin{array}{c}
\sin \frac{\pi}{5} \\
\sin \frac{2\pi}{5} \\
\sin \frac{3\pi}{5} \\
\sin \frac{4\pi}{5} 
\end{array}\right]
 $$</p>
<p><img alt="" src="6_2.png" /></p>
<p>Bu da ikinci özvektör (özfonksiyon). </p>
<p>$$ 
y_2 = 
\left[\begin{array}{c}
sin \frac{2\pi}{5} \\
sin \frac{4\pi}{5} \\
sin \frac{6\pi}{5} \\
sin \frac{8\pi}{5} 
\end{array}\right]
 $$</p>
<p><img alt="" src="6_3.png" /></p>
<p>Özvektörler olduğunu söylemekle ikinci bir şey daha söylüyoruz, bu iki
vektör birbirine dik. Buradan hareketle $\sin(\pi x)$ fonksiyonu (iki
üstteki resim) $\sin(2\pi x)$ fonksiyonuna (bir üstteki resim) dik
diyebilirdik, ki hakikaten öyledir. Hatta bu matematiksel durum Fourier
Serilerinin işlemesini sağlayan önemli bir etkendir.</p>
<p>Bu bağlantıdan devam edelim: pür vektörler olduğu zaman diklik kontrolü için
$y_1^T \cdot y_2$ diyordum, ve $y_1$ ve $y_2$'nin eşleşen elemanları birbiriyle 
çarpılıp, bu sonuçlar teker teker toplanıyordu. Elimde $y_1$ ve $y_2$ için 
birer fonksiyon var ise, bir tarafta $\sin(\pi x)$ var, her $x$ için değişik
değerler veriyor, diğer tarafta $\sin(2\pi x)$ var, bunları çarpıp toplamam
lazım. Ama elimde teker teker toplayabileceğim değerler olmadığı için ($x$ reel
bir sayıdır, belli bir aralıkta bile sonsuz tane değere sahip olabilir), o
zaman toplama yerine entegrasyon kullanmam lazım. O zaman</p>
<p>$$ y_1^T \cdot y_2  = \int_0^1 (\sin \pi x)(\sin 2\pi x) \mathrm{d} x  $$ </p>
<p>Sonuç sıfır gelecek, çünkü iki fonksiyon birbirine dik.</p>
<p>Soru 1.5.3</p>
<pre><code class="python">import scipy.linalg as lin

def ktbc(n):
    vec = np.zeros((1,n))
    vec[0,0] = 2
    vec[0,1] = -1
    K = lin.toeplitz(vec)
    T = np.copy(K)
    T[0,0] = 1
    B = np.copy(K)
    B[0,0] = 1
    B[n-1,n-1] = 1
    C = np.copy(K)
    C[n-1,n-1] = 1

    return K, T, B, C

import scipy.linalg as lin
import ktbc

K,T,B,C =  ktbc.ktbc(5)

u,v=lin.eig(K)

print u

print 2-np.sqrt(3), 2-1, 2-0, 2+1, 2+np.sqrt(3)

print 2*np.ones((5,1)).T - 2*np.cos((np.arange(5)+1) * np.pi/6)
</code></pre>

<pre><code>[ 3.73205081+0.j  3.00000000+0.j  2.00000000+0.j  0.26794919+0.j
  1.00000000+0.j]
0.267949192431 1 2 3 3.73205080757
[[ 0.26794919  1.          2.          3.          3.73205081]]
</code></pre>
        </section>          
      </div>
    </body>
</html>
