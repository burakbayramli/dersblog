<h1>C++ Programlarının Performansını Ölçmek</h1>
<p>Kodun içinde hangi bloğun ne kadar zaman aldığını ölçmek kodu optimize
etmek için gündeme gelir. Altta bir kronometre kodu var, [1]'de
görülen bir kronometre objesi yaratmak ve onu başlatıp durdurduktan
sonra ne kadar zaman geçtiğini raporlamak.</p>
<p>Bizim yaptığımız ek birden fazla başlatıp durdurabilmek, böylece bir
fonksiyon pek çok kez çağrılıyorsa mesela o fonksiyon başında sonunda
sürekli başlatıp durdurma sonrası toplam o fonksiyonda ne kadar zaman
harcandığını ölçebilmek. </p>
<p>Ya farklı kod bloklarını ölçmek istersek? O zaman alttaki sınıftan her
blok için ayrı obje yaratabiliriz böylece o her bloğun zaman kaydı
ayrı tutulur.</p>
<pre><code class="cpp">#include &lt;iostream&gt;
#include &lt;chrono&gt;
#include &lt;ctime&gt;
#include &lt;cmath&gt;

class Timer
{

    double totalElapsed = 0.f;

private:
    std::chrono::time_point&lt;std::chrono::system_clock&gt; m_StartTime;
    std::chrono::time_point&lt;std::chrono::system_clock&gt; m_EndTime;

public:
    void start()
    {
        m_StartTime = std::chrono::system_clock::now();
    }

    void stop()
    {
        m_EndTime = std::chrono::system_clock::now();
    totalElapsed = totalElapsed + std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(m_EndTime - m_StartTime).count();
    }

    double elapsedMilliseconds()
    {        
        return totalElapsed;
    }

    double elapsedSeconds()
    {
        return elapsedMilliseconds() / 1000.0;
    }

};

</code></pre>

<pre><code class="cpp">#include &quot;cronometer.h&quot;

long fibonacci(unsigned n)
{
    if (n &lt; 2) return n;
    return fibonacci(n-1) + fibonacci(n-2);
}

int main()
{    
    Timer timer;

    // ilk kez baslat
    timer.start();
    for (int i=0;i&lt;100;i++){
    fibonacci(30);
    }
    timer.stop();    
    std::cout &lt;&lt; &quot;Milliseconds: &quot; &lt;&lt; timer.elapsedMilliseconds() &lt;&lt; std::endl;

    // ikinci kez baslat, onceki zamanin ustune eklenmesi lazim
    timer.start();
    for (int i=0;i&lt;100;i++){
    fibonacci(30);
    }
    timer.stop();

    std::cout &lt;&lt; &quot;Milliseconds: &quot; &lt;&lt; timer.elapsedMilliseconds() &lt;&lt; std::endl;
}
</code></pre>

<p>Derlemek ve işletmek için,</p>
<pre><code>g++ test.cpp  -o /tmp/run.exe; /tmp/run.exe
</code></pre>

<p>Dikkat: Bir fonksiyonun başında <code>start()</code> sonunda <code>stop()</code> koyduğumuz
zaman unutmayalım, bu her zaman yeterli olmayabilir, eğer fonksiyonun
kodununun ortasında belli bazı şartlarda <code>return</code> ile direk dönüş
yapıyorsak, o zaman bu dönüş öncesi de bir <code>stop</code> eklememiz gerekir.</p>
<p>Kaynaklar</p>
<p>[1] https://gist.github.com/mcleary/b0bf4fa88830ff7c882d</p>