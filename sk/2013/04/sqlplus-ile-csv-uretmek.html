
<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
   <script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
   </script>
   <link rel="stylesheet" type="text/css" media="screen" href="https://burakbayramli.github.io/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1548953794786292"
          crossorigin="anonymous"></script>  
  </head>
    <body>
      <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">
            <a href="https://burakbayramli.github.io" style="text-decoration:none; color:inherit;">dersblog</a>
          </h1>
          <h2 id="project_tagline"></h2>          
        </header>
      </div>
      <div id="main_content_wrap" class="outer">        
        <section id="main_content" class="inner">
        <h1></h1>
<h1>Sqlplus ile CSV Uretmek</h1>

<p>Komut satirindan sqlplus ile CSV uretmek icin</p>

<pre><code>set echo offset verify offset
termout onset
heading offset
pages 50000
set feedback offset
newpage noneset
linesize 250
set colsep '|'spool out.csv;
select 
kolon1 || '|' ||
kolon2 
from tablo where filtre = 'filan';spool off;exit;
</code></pre>

<p>Bu sql dosyasini mesela test.sql olarak kaydedersek,</p>

<pre><code>sqlplus64 user/pass@db @test.sql
</code></pre>

<p>ile isletebiliriz, ve ciktiyi out.csv icinde goruruz. Kolon degerleri
| ile ayrilmis olacaktir. Okunan tablo ismi goruldugu gibi tablo,
zaten ciktiyi uretecek SQL ozellikle belirtiliyor.</p>

<p>SQLPlus'un CSV üretmek için pek iyi bir ortam olduğu söylenemez. Zaten
bu araçın "şekli olarak veri üretmek" olduğu söyleniyor, tabii
70-80'li yılların text bazlı ortamı için kolonsal şekiller üretmek
anlamında.. Bu şekli eğilim sadece veriyi çekip çıkartmak isteyenler 
için problem olabiliyor. Mesela linesize parametresine dikkat, bu
parametre bir satırda kaç karakter olacağını tanımlar, eğer veri
satırında o kadar karakter yoksa, o zaman linesize boşluk karakteri
ile doldurulur (daha fazla veri gelmişse de fazla olan karakterler
kesip atılır! dikkat). Bu boşluk karakteri satırdaki en son kolonu
okurken problem çıkartabilir, Pandas ile mesela skipinitialspace=True
ile bu boşluktan kurtulmak gerekiyor.</p>

<p>Kolonlari yanyana ve | ile ayrilacak sekilde biz yanyana getiriyoruz,
cunku baska turlu tum bilgilerin ardi ardina sirilanmasi mumkun
olmuyor (colsep ile set edilen ayarin pek bir anlami yok yani).</p>

<p>Ayrica SQLPlus kolon isimlerini otomatik olarak vermiyor. Biz bu
isimleri Pandas ile okurken kendimiz veriyoruz.</p>

        </section>          
      </div>
    </body>
</html>
