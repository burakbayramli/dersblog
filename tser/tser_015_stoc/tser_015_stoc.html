<!DOCTYPE html>
<html>
  <head>
    <title>Olasılıksal Calculus (Stochastic Calculus)
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
   <script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
   </script>
   <link rel="stylesheet" type="text/css" media="screen" href="https://burakbayramli.github.io/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1548953794786292"
          crossorigin="anonymous"></script>  
  </head>
    <body>
      <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">
            <a href="https://burakbayramli.github.io" style="text-decoration:none; color:inherit;">dersblog</a>
          </h1>
          <h2 id="project_tagline"></h2>          
        </header>
      </div>
      <div id="main_content_wrap" class="outer">        
        <section id="main_content" class="inner">
        <h1>Olasılıksal Calculus (Stochastic Calculus)
</h1>

<p>Wiener Süreçleri </p>
<p>Ayrıksal olarak işlediğimiz $X_t$'yi sürekli ortamda şöyle geliştirebiliriz;
Yeni bir değişken tanımlayalım, ${ X_t^{\Delta}, t \ge 0 }$ kronolojik olarak
sıralanmış rasgele değişkenler olacaklar, fakat artık $t$ artık bir tamsayı /
indis değil, bir reel sayı. Finansal varlıklar, senetler tabii ki ayrıksal
olarak hesaplanırlar, mesela her günün kapanış fiyatı baz alınırak, fakat
fiyatların dalgalanışına sürekli zaman süreci olarak bakmak matematiksel olarak
bazı hesapların kolaylaşmasını sağlıyor.</p>
<p>Öyle bir rasgele (stochastic) süreç ${ X_t^{\Delta}, t \ge 0 }$ düşünelim ki
her eşit zaman adımı $\Delta t$ içinde 1/2 olasılıkla $\Delta x$ kadar yukarı ya
da aşağı inecek. $n$ adım sonrası zaman anı $t = n \cdot \Delta t$ sürecin
içinde olduğu konum</p>
<p>$$ X_t^{\Delta} = \sum_{k=1}^{n} Z_k \Delta x = X_n \Delta x $$</p>
<p>olacaktır, ki $Z_k = -1/+1$ değerini $1/2$ şansla verebilecek rasgele
değişken. Böylece $Z_1 \Delta x,Z_2 \Delta x$ artışları ortaya çıkıyor, bu
artışlar birbirinden bağımsızdır, ve $1/2$ şans ile $-\Delta x$ ya da $\Delta x$
değerine sahiptir. Bazı hesaplar</p>
<p>$$ E[X_t^{\Delta}] = 0 $$</p>
<p>çünkü beklenti operatörü toplama nüfuz edebilir, ve $E[Z_k] = 0$. Ayrıca,</p>
<p>$$ Var(X_t^{\Delta}) = (\Delta x)^2 Var(X_n) =  (\Delta x)^2 \cdot n$$</p>
<p>çünkü $Var(Z_k) = 1,Var(X_n)=n$. Ayrıca önce belirttik, $t = \Delta x \cdot n$,
cebirsel değişim ile $n = t / \Delta t$, o zaman üstteki,</p>
<p>$$ Var(X_t^{\Delta}) = t \cdot \frac{(\Delta x)^2}{\Delta t}  $$</p>
<p>Şimdi $\Delta t,\Delta x$'i çok küçültelim. Fakat bu sürecin bir sonsuza gidip
patlamaması, yani makul bir limitinin olması için $Var(X_t^{\Delta})$ sonlu
(finite) olmalıdır. Diğer yandan varyans sıfır a da yaklaşmamalıdır, çünkü o
zaman bu süreç rasgele olmaz (hiç sapma yok ise rasgelelik kalmamış
demektir). Demek ki bize bir sonsuz olmayan bir tam sayı verecek bir seçim
yapmak lazım, bunu da</p>
<p>$$\Delta t \to 0, \Delta x = c \cdot \sqrt{\Delta t}$$</p>
<p>olarak yapmamız gerekir, ki böylece </p>
<p>$$Var(X_t^{\Delta}) \to c^2t$$ </p>
<p>olur. </p>
<p>$\Delta t$'nin ufak olduğu durumda $n = t/\Delta t$ doğal olarak büyük olur. Bu
derece büyüklüklerde olanlara sonuşur (asymptotic) bağlamda olarak bakabiliriz,
ayrıksal versiyondaki rasgele değişken $X_n$ yaklaşıksal olarak $N(0,n)$
dağılımına sahiptir, o zaman tüm $t$'ler için (dikkat sadece $t = n \Delta t$
olan $t$'ler için değil) $X_t^{\Delta} \sim N(0, n(\Delta x)^2) \sim N(0, c^2t)$
dağılımına sahip olacaktır.</p>
<p>Yani ${ X_t^{\Delta}, t \ge 0 }$'nin limitli süreci olarak elde ettiğimiz yeni
${ X_t, t \ge 0 }$'nin $\Delta x = c \sqrt{\Delta t}, \Delta t \to 0$ iken şu
özellikleri vardır,</p>
<p>1) $X_t$ tüm $t \ge 0$ için $N(0,c^2t)$ dağılıma sahiptir. </p>
<p>2) ${ X_t, t \ge 0 }$ bağımsız adımlara sahiptir, mesela $0 \le s &lt; t,
X_t-X_s$ değeri $X_s$'den bağımsızdır, çünkü ${ X_t, t \ge 0 }$'yi tanımlamak
için kullandığımız rasgele yürüyüş ${ X_n, t \ge 0 }$ bağımsız adımlara
sahiptir.</p>
<p>3) $0 \le s &lt; t$ için artış $X_t-X_s$'in dağılımı $N(0, c^2 \cdot (t-s))$'tir,
yani herhangi bir artışın dağılımı sadece ve sadece $t-s$'in büyüklüğüne
bağlıdır. Tabii bu özellik aslında (i), (ii) ve normal dağılımların
özelliklerinin doğal bir uzantısı.</p>
<p>Sürekli zamanda tanımlı olan rasgele süreç ${ X_t, t \ge 0 }$ eğer (1)-(3)
şartlarına uygunsa bu sürece Wiener süreci, ya da Brownian süreci ismi verilir,
sürecin 0 anında $X_0=0$ olarak başladığı kabul edilir. Eğer $c=1$ alınırsa
ortaya çıkan sürece <em>standart Wiener süreci</em> denir ve çoğu kaynakta bu süreç
$W$ harfiyle tanımlanır, yani ${ W_t, t \ge 0 }$.</p>
<p>Standart Wiener süreçleri için, $0 \le s &lt; t$ bağlamında, şu alttakiler
geçerlidir,</p>
<p>$$ E[W_t] = 0, Var(W_t) = t $$</p>
<p>$$ Cov(W_t,W_s) = Cov(W_t-W_s+W_s, W_s) $$</p>
<p>$$ = Cov(W_t-W_s,W_s) + Cov(W_s,W_s) $$</p>
<p>$$ = 0 + Var(W_s) = s $$</p>
<p>İlginç bir durum şudur: Wiener sürecinin türevi yoktur [4, sf. 59]!.</p>
<p>Rasgele Entegraller (Stochastic Integrals)</p>
<p>Farz edelim ki $f(\cdot)$ $[a,b]$ aralığında türevi olan sürekli bir
fonksiyon. Rasgele entegral şu şekilde tanımlanabilir, $\forall i$</p>
<p>$$
\int_{ a}^{b} f(t) \mathrm{d} W_t \equiv<br />
\lim_{ n \to \infty, |t_i-t_{i-1}| \to 0 }
\sum_{i=1}^{n} f(t_{i-1}) ( W_{t_i} - W_{t_{i-1}})
$$</p>
<p>Tanımın sağındaki bir Riemann toplamıdır. Dikkat, burada $dW_t$ "türev almak"
olarak görülmemeli çünkü $W_t$'nin türevi yok. Üstte bir entegral tanımı yaptık
ve o tanıma tekabül eden açılımı belirttik. Yani bu tanımı ne zaman görürsek
içinde limit olan ifadeyi hatırlamamız lazım.</p>
<p>Not: $W_{t_i} - W_{t_{i-1}}$'in daha önce normal dağılımda olduğunu
görmüştük. Demek ki aralıklar bir tür "beyaz gürültü"dür (white noise).</p>
<p>Bir numara / tanım değiştirme durumu daha: Diyelim ki parçalı entegral yöntemini
kullanabiliyoruz,</p>
<p>$$ \int u \cdot \mathrm{d} v = uv - \int v \cdot \mathrm{d} u $$</p>
<p>Ana formülü $u,v$ bazında bölüştürelim,</p>
<p>$$ \int_{a}^{b} \underbrace{f(t)}<em>{u}\underbrace{\mathrm{d} W_t}</em>{\mathrm{d} v}$$</p>
<p>O zaman </p>
<p>$$ \int_{a}^{b} f(t)\mathrm{d} W_t = f(b)W_b - f(a)W_a - \int_{a}^{b} W_t \mathrm{d} f(t) $$</p>
<p>Genellikle eşitliğin sol tarafının kullanılan, bilinen tanımı budur. Rasgele
entegral dediklerinde bahsedilen bu yani. Bir ek güzellik, $f$'in türevi
alınabildiği için çoğunlukla $df(t)$ yerine $f'(t)$ de kullanılabilir.</p>
<p>Parçalı entegral yöntemi iyi işledi, üstelik işi kitabına uygun yapıyor - $u,dv$
bölüştürmesi yaparken $dv=dW_t$ elde ettik, bu sayede $v$'ye atladık, ki bu
tekrar bize $W_t$ verdi.</p>
<p>Rasgele Diferansiyel Denklemler (Stochastic Differential Equations -SDE-)</p>
<p>Wiener süreçleri sıfır etrafında salınan bir süreçtir, fakat uygulamalarda bize
büyüyen seriler gerekebilir, bir trendi ya da kayması (drift) olacak
şekilde. Herhangi bir sabit değeri $\sigma^2$ ve $\mu$ ile genelleştirilmiş bir
Wiener süreci ${ X_t; t&gt;0}$'i şöyle gösterebiliriz [4, sf. 64],</p>
<p>$$ 
X_t = \mu \cdot t + \sigma \cdot W_t, \qquad t&gt;0 
\qquad (1)
$$</p>
<p>Bu süreç $t$ anında $N(\mu,\sigma^2t)$ dağılımına sahip olacaktır. Ufak bir
zaman artışı $\Delta t$ için</p>
<p>$$ X_{t + \Delta t} - X_t = \mu \cdot \Delta t + \sigma (W_{t+\Delta t}-W_t)$$</p>
<p>$\Delta t \to 0$ iken diferansiyel notasyonunu kullanabiliriz, </p>
<p>$$ dX_t = \mu \cdot dt + \sigma dW_t $$</p>
<p>Bu formül (1)'in değişik bir halinden ibarettir. Üsttekini entegral
formunda da yazabiliriz, </p>
<p>$$ X_t = \int_{0}^{t}\mu \mathrm{d} s + \int_{ 0}^{t} \sigma \mathrm{d} W_s $$</p>
<p>Dikkat edersek daha önceki rasgele entegral tanımından, hemen şu hesabı
yapabildiğimizi görürüz, $\int_{0}^{s} \mathrm{d} W_s = W_t - W_0 = W_t$, çünkü
$W_0=0$. </p>
<p>Ornstein-Uhlenbeck Süreçleri</p>
<p>[3, sf. 46]'da bahsedilen bu formül, ve hayat yarılama zamanı arasındaki
ilişkiyi daha iyi anlamak için önce formülün nasıl türetildiğini görelim,
ardından beklentisi üzerinden hayat yarılama zamanını bulabileceğiz. Ortalamay
dönüş bölümünde senet üzerinde hesapsal bir örnek te veriyoruz.</p>
<p>$$ dX_t = \alpha(\mu - X_t)dt + \sigma dW_t $$</p>
<p>Bazen tüm formül $dt$ ile bölünüp şu şekilde de belirtilebiliyor, </p>
<p>$$ \frac{dX_t}{dt} = \alpha(\mu - X_t) + \sigma W_t' $$</p>
<p>Rasgele diferansiyel denklemlerde $dW_t$, $W_t'$ benzeri ifadeler ne demektir?
$dW_t$ mesela "beyaz gürültü" olarak tanımlanır, peki niye gürültü için
bilinen normal dağılım denkleme rasgele değişken olarak dahil edilmemiştir?
Bunun sebebi üsttekinin bir diferansiyel denklem olması, çözüm için bir şekilde
entegral alınca bir rasgele değişkenin çarpımı üzerinden entegral almak
gerekirdi. Onun tanımı belli değişimi üzerinden entegralini almak için
geliştirilmiş rasgele calculus var, bu araçları devreye sokabiliriz.</p>
<p>Ornstein-Uhlenbeck formülüne dönelim, O-U aslında ortalamaya dönüşün
(mean-reversion) SDE formunda belirtilmiş halidir. $X_t$ yerine $y_t$
kullanalım, ve + kullanıp $\lambda$ ekleyelim, ki [3] notasyonuna uysun,</p>
<p>$$ dy_t = (\lambda y_t + \mu)dt + dW_t  $$</p>
<p>Bu formül $\mu$'den ne kadar uzaklaşılırsa, ve eğer $\lambda$ eksi ise o kadar
zaman serisi üzerinde ters yönde bir baskı yaratacaktır. $\lambda$'nin ne
olduğu, büyüklüğü ve hatta eksi mi artı mı olduğu veriden hesaplanır, bu hesap
bize zaman serisi hakkında önemli sinyaller verecek. Eğer $\lambda$ eksi değil
ise ortalamaya dönüş sonucuna varamayacağız mesela.</p>
<p>Üstteki denklemi çözelim. Önce iki tarafı da $e^{-\lambda t}$ çarpalım, ve
tekrar düzenleyelim,</p>
<p>$$ e^{-\lambda t}dy_t = e^{-\lambda t}(\lambda y_t + \mu)dt + e^{-\lambda t} dW_t  $$</p>
<p>$$ e^{-\lambda t}dy_t - e^{-\lambda t}(\lambda y_t + \mu)dt =  e^{-\lambda t} dW_t 
\qquad (2)
$$</p>
<p>Şimdi $e^{-\lambda t}(\lambda y_t + \mu)$'in diferansiyeline bakalım, bu
bize ileride lazım olacak,</p>
<p>$$ d(e^{-\lambda t}(\lambda y_t + \mu)) = 
-\lambda e^{\lambda t} (\lambda y_t + \mu) dt + e^{\lambda t} \lambda dy_t 
$$</p>
<p>$dt$ nereden geldi? Hatırlayalım </p>
<p>$$ d(uv) = u dv + v du $$</p>
<p>$d(e^{?})/dt$ bize $e$'nin kendisini verirdi, ve $dt$ ile çarpınca, tek $dt$
üstteki görülen yerdedir. Devam edelim, iki üstteki denklemin sağ tarafının
(2)'nin sol tarafı ile aynı olduğunu görüyoruz (zaten bütün bu taklaları o
eşitliğe erişmek için attık). O zaman</p>
<p>$$ d(e^{-\lambda t}(\lambda y_t + \mu)) =  e^{-\lambda t} dW_t  $$</p>
<p>diyebiliriz. Şimdi iki tarafın entegralini alalım,</p>
<p>$$
\int_{0}^{t} d(e^{-\lambda s}(\lambda y_s + \mu)) =
\int_{0}^{t} e^{-\lambda s} \mathrm{d} W_s
$$</p>
<p>$$
e^{-\lambda s}(\lambda y_s + \mu) \big|<em>{0}^{t} =
\int</em>{0}^{t} e^{-\lambda s} \mathrm{d} W_s
$$</p>
<p>$$
e^{-\lambda t}(\lambda y_t + \mu) - \lambda y_0 - \mu =
\int_{0}^{t} e^{-\lambda s} \mathrm{d} W_s
$$</p>
<p>$$
e^{-\lambda t}\lambda y_t + e^{-\lambda t}\mu - \lambda y_0 - \mu =
\int_{0}^{t} e^{-\lambda s} \mathrm{d} W_s
$$</p>
<p>$$ 
e^{-\lambda t}\lambda y_t  =
- e^{-\lambda t}\mu + \lambda y_0 + \mu + \int_{0}^{t} e^{-\lambda s} \mathrm{d} W_s 
$$</p>
<p>$$ 
\lambda y_t   =
- \mu + e^{\lambda t} \lambda y_0 + e^{\lambda t}\mu + \int_{0}^{t} e^{\lambda (t-s)} \mathrm{d} W_s 
$$</p>
<p>$$ 
y_t   = \frac{-\mu}{\lambda} + e^{\lambda t} y_0 + e^{\lambda t}\frac{\mu}{\lambda} + 
\frac{1}{\lambda}\int_{0}^{t} e^{\lambda (t-s)} \mathrm{d} W_s 
$$</p>
<p>$$ 
y_t = \frac{-\mu}{\lambda} ( 1 - e^{\lambda t}) + e^{\lambda t} y_0 + 
\frac{1}{\lambda}\int_{0}^{t} e^{\lambda (t-s)} \mathrm{d} W_s 
$$</p>
<p>Nihayet $y_t$'ye eriştik. Şimdi iki tarafın beklentisini alırsak, entegral
içine nüfuz eden bu işlem ardından $dW$ beklentisi doğal olarak sıfıra
gidip yokolacak, geri kalanlar,</p>
<p>$$ 
E[y_t] = y_0 e^{\lambda t} - \frac{\mu}{\lambda} ( 1 - e^{\lambda t}) 
\qquad (3)
$$</p>
<p>Zaman Yarılaması</p>
<p>Radyoaktif çürüme (decay), mesela Uranyum 238 için, alttaki denklemle
modellenir [5, sf. 269],</p>
<p>$$ \frac{\mathrm{d} u}{\mathrm{d} t} = - \lambda u$$</p>
<p>$u(t)$ formülü $t$ anında ne kadar madde olduğu, $\lambda &gt; 0$ ise çürüme
oranını kontrol ediyor. Üstteki denklemin çözümü,</p>
<p>$$ u(t) = c e^{-\lambda t} $$</p>
<p>ki $c$ başlangıç madde miktarı. Bu tür konularda hayat yarılama zamanı
(half-life) kabaca madde yokoluşu hakkında fikir yürütmek için iyi bir ölçüttür,
bu süre, $u(t)$'nin başlangıç maddesinin yarısı, yani $1/2 c$ olduğu $t^\ast$
anıdır,</p>
<p>$$ u(t^\ast) = c e^{-\lambda t^\ast} = 1/2 c$$</p>
<p>$$  e^{-\lambda t^\ast} = 1/2 $$</p>
<p>İki tarafın log'unu alıp tekrar düzenleyelim,</p>
<p>$$ t^\ast = -\log(0.5)/\lambda $$</p>
<p>$$ t^\ast  = \log(2)/\lambda $$</p>
<p>bize hayat yarılama zamanını verir. Şimdi (3)'e bir daha bakalım, burada çürüme
$y_0 e^{\lambda t}$ teriminde. O zaman hayat yarılama zamanı $-\log(2)/\lambda$
ile; eksi çünkü O-U denkleminde $\lambda$'nin negatif olmasına izin verdik.</p>
<p>Bazı örnek değerler ile bir grafik,</p>
<pre><code class="python">y0 = 10; lam=-0.5;mu=2
x = np.linspace(0,10,100)
y = y0*np.exp(lam*x) - mu/lam* (1-np.exp(lam*x))
plt.scatter(x,y)
plt.savefig('tser_stoc_11.png')
plt.hold(False)
</code></pre>

<p><img alt="" src="tser_stoc_11.png" /></p>
<pre><code class="python">import statsmodels.formula.api as smf
import pandas as pd
import numpy as np

def halflife(df,col):
    df['ylag'] = df[col].shift(1)
    df['deltaY'] = df[col] - df['ylag']
    results = smf.ols('deltaY ~ ylag', data=df).fit()
    lam = results.params['ylag']
    halflife=-np.log(2)/lam
    return lam, halflife
</code></pre>

<p>Kaynaklar </p>
<p>[1] Shalizi, <em>Advanced Data Analysis from an Elementary Point of View</em></p>
<p>[2] Rupert, <em>Statistics and Data Analysis for Financial Engineering</em></p>
<p>[3] Chan, <em>Algorithmic Trading</em></p>
<p>[4] Franke, <em>Statistics of Financial Markets</em></p>
<p>[5] Olver, <em>Applied Mathematics</em></p>
        </section>          
      </div>
    </body>
</html>
