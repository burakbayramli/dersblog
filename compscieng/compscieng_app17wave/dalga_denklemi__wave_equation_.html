<!DOCTYPE html>
<html>
  <head>
    <title>Dalga Denklemi (Wave Equation)
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
   <script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
   </script>
   <link rel="stylesheet" type="text/css" media="screen" href="https://burakbayramli.github.io/css/style.css">
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1548953794786292"
          crossorigin="anonymous"></script>  
  </head>
    <body>
      <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">
            <a href="https://burakbayramli.github.io" style="text-decoration:none; color:inherit;">dersblog</a>
          </h1>
          <h2 id="project_tagline"></h2>          
        </header>
      </div>
      <div id="main_content_wrap" class="outer">        
        <section id="main_content" class="inner">
        <h1>Dalga Denklemi (Wave Equation)
</h1>

<p>Denklem [1],</p>
<p>$$
\frac{\partial^2 y}{\partial x^2}  =
\frac{1}{c^2}\frac{\partial^2 y}{\partial t^2}
$$</p>
<p>Denkleme yakından bakarsak onun bir kısmı türevsel denklem (PDE) olduğunu
görürüz. İki tane bağımsız değişken temel alınıyor, $x,t$. Ayrıca denklem
2. derece, çünkü ikinci türevi içeriyor. Bu bilgiler denklemi çözmek için
önemli [2].</p>
<p>Çözümde bir başlangıç şartı gerekli çünkü diferansiyel denklemleri "entegre
ederken" daha doğrusu ileri doğru geçen zamanda hesaplarken bir başlangıç
noktası gerekiyor, bunun için bir teli kaldırıp (geçici bir süre üçgen haline
getirip) oradan bıraktığımızı düşünebiliriz, ki bu üçgen şekli alttaki gibi
modellenebilir,</p>
<p>$$
y(x,t=0)=\begin{cases}
1.25 x/L , &amp;x\leq 0.8 L ,\\
(5-5x/L), &amp;x&gt; 0.8 L,
\end{cases} 
$$</p>
<p>İkinci bir başlangıç şartı daha lazım, 2. derece başlangıç şartı bu. Teli, ipi
gerip üçgen yaptım ama sonra durup tekrar bıraktım, bu da bir başlangıç şartı,
durağan durumdan başlama şartı.</p>
<p>$$
\frac{\partial y} {\partial t}(x,t=0) =0
$$</p>
<p>Çözüme bu şartlarla başlayabilirdik ama baştaki problem tanımını hatırlarsak ek
bazı şartlar daha koymuştuk, bu şartlar, kısıtlamalar her an için geçerli,
ipler iki ucundan (hareket etmeyen) duvarlara bağlı.</p>
<p>$$
y(0,t) \equiv 0, \quad y(L,t) \equiv 0
$$</p>
<p>[analitik çözüm atlandı]</p>
<p>Yaklaşıksal hesap için $x,t$ eksenleri düşünebiliriz, ve bu eksenlerde
sadece belli noktalardaki hesaplar yapılacak, $x$ için aralıklar $\Delta x$
genişliğinde, $t$ için $\Delta t$ genişliğinde, aralık büyüklüğünü biz
tanımlayacağız. Yani hesap noktaları $i=1,2,3,...$ için $i \Delta t$'de,
$x$ için $j=1,2,..$ ile $j \Delta t$'de.</p>
<p><img alt="" src="compscieng_app17wave_03.png" /></p>
<p>Yaklaşıksallıkta bir diğer kullanılacak teknik merkezi farklılıklar, burada $x$
için sola/sağa, $t$ için yukarı/aşağı olacak şekilde iki Taylor açılımı
yapıyoruz,</p>
<p>$$
y(x +\Delta x, t)  = y(x,t) +
\frac{\partial U}{\partial x}\Delta x + \frac{1}{2}
\frac{\partial^2 U}{\partial x^2}(\Delta x)^2 + \cdots
$$</p>
<p>$$
y(x -\Delta x, t)  = y(x,t) -
\frac{\partial U}{\partial x} \Delta x + \frac{1} {2}
\frac{\partial^2 U}{\partial x^2} (\Delta x)^2 - \cdots
$$</p>
<p>$$
y(x, y +\Delta t)  = y(x,t) +
\frac{\partial U}{\partial t}\Delta y + \frac{1}{2}
\frac{\partial^2 U}{\partial t^2}(\Delta t)^2 + \cdots
$$</p>
<p>$$
y(x, y -\Delta t) = y(x,t) -
\frac{\partial U}{\partial t} \Delta t + \frac{1} {2}
\frac{\partial^2 U}{\partial t^2} (\Delta t)^2 - \cdots
$$</p>
<p>Noktalı yerlerdeki terimleri yok sayıyoruz (2. derece yaklaşıklama yapmış olduk
yani, bu önemli, yaklaşık temsilin kuvvetini gösteriyor bir anlamda), sonra her
değişkenin iki açılımını birbiri ile topluyoruz. Toplama sonrası tek sayı
terimlerinin iptal olduğunu görürüz, ve kalanlar,</p>
<p>$$
\frac{\partial^2 y(x,t)}{\partial x^2} \simeq
\frac{y(x+\Delta x,t)+y(x-\Delta x,t)-2 y(x,t)}{(\Delta x)^2}
$$</p>
<p>$$
\frac{\partial^2 y(x,t)}{\partial t^2} \simeq
\frac{y(x,t+\Delta t) +y(x, y-\Delta t)-2 y(x,t)}{(\Delta t)^2}
$$</p>
<p>olacaktır. İndisler üzerinden belirtirsek,</p>
<p>$$
\frac{\partial^2 y }{\partial t^2} \simeq
\frac{y_{i,j+1}+y_{i,j-1}-2 y_{i,j}}{(\Delta t)^2}, \quad
\frac{\partial^2 y}{\partial x^2} \simeq
\frac{y_{i+1,j}+y_{i-1,j}-2 y_{i,j}} {(\Delta x)^2}.
$$</p>
<p>Üstteki formülleri dalga denklemindeki yerlerine koyarsak,</p>
<p>$$
\frac{y_{i,j+1}+y_{i,j-1}-2 y_{i,j}} {c^2 (\Delta t)^2}  =
\frac{y_{i+1,j}+y_{i-1,j}-2 y_{i,j}} {(\Delta x)^2}
\qquad (2)
$$</p>
<p>Tabii dikkat edersek geçmiş $j-1$ ve gelecek $j+1$ birbirine karışmış durumda,
bize lazım olan geleceğin hesabının eşitliğin sol tarafında olması geri kalan
her şey sağda olacak şekilde tekrar düzenlersek,</p>
<p>$$
y_{i,j+1}  = 2 y_{i,j}-y_{i,j-1}+ \frac{c^2 } {c'^{2}}
\left [ y_{i+1,j}+y_{i-1,j}-2 y_{i,j}\right], \quad c' { = }
\frac {\Delta x}{\Delta t}
\qquad (1)
$$</p>
<p>Hesap için üstteki resmi hatırlayalım, $i,j+1$ hücresine dört diğer hücreden ok
çizilmiş, aslında bu oklar üstteki formülün hesabını anlatıyor, o anki $t$
zamanından üç hesap ve geçmişten $i,j-1$ hesabına bakarak gelecekteki değeri
hesaplıyoruz. Bu hesaplama çok verimli olacak çünkü herhangi bir anda hafızada
tutulması gereken $y(i,j)$ haricinde sadece üç tane değer var. </p>
<p>Son bir problem başlangıç anı ile alakalı, resimdeki bilinmesi gereken o üç
hücrenin başlangıç $j=1$ anında olduğunu düşünürsek, ve $j=2$'yi hesaplamamız
gerekiyor, eksi zamana doğru bir gidişat lazım, yani $j=-1$ zamanı. Başlangıç
bilgisi $j=1$ var, ama $j=-1$ yok. Buradaki bilgiyi nasıl alacağız?</p>
<p>Denklemsel olarak bir ek koşul daha ekleyerek, ilk başta hem teli çekip üçgen
haline getirmiştik, bir de başlangıç anında telin hızı sıfırdır diyeceğiz. Bu
mantıksız değil, tel çekildi, tutuluyor.. hareket yok. Denklem olarak
$\partial y / \partial t(x,0)$ sıfır diyeceğiz. Sonra bu denklemin merkezi
farklılık açılımını yapacağız ve oradan gelen eşitlikleri ana (1)'e sokarak
sadece $j=2$ için özel bir formül elde etmeyi umuyoruz.</p>
<p>$$
\frac{\partial y}{\partial t}(x,0) \simeq
\frac{y(x, \Delta t)- y(x, -\Delta t)}{2\Delta t}=0, \
\Rightarrow \ y_{i, 0} = y_{i,2}
$$</p>
<p>(1)'e sokunca</p>
<p>$$
y_{i,2} = y_{i,1}+ \frac{c^2} {c'^2}
\left [ y_{i+1,1}+y_{i-1,1}-2 y_{i,1}\right]
$$</p>
<p>Dikkat bu denklem sadece $j=2$ için. Bundan sonraki her $j$ için ana (1) formülü
işleyecektir.</p>
<p>Stabilite, von Neumann</p>
<p>Çözümün stabil olması için $c \le \frac{\Delta x}{\Delta t}$ şartının doğru
olması gerekir, ve çoğunlukla $\Delta x$ bizim kontrolümüzde olmaz, problemin
dayattığı bir büyüklük olur, $c$ fiziki modelin bir parçasıdır, o zaman $\Delta t$'nin
diğer verili parametrelere göre şarta uygun seçilmesi gerekir. Şarta von
Neumann ya da Courant stabilite şartı ismi veriliyor.</p>
<p>Türetmek için alttaki gibi bir yaklaşım [3] kullanılabilir. Fakat ilerlemeden
önce Euler denkleminden türetilen bazı ek formülleri görelim, bu formüller
birazdan işimize yarayacak. Euler formülü hatırlarsak,</p>
<p>$$
e^{ix} = \cos (x) + i\sin(x)
$$</p>
<p>Üstteki formülü $-x$ için yazarsak,</p>
<p>$$
e^{-ix} = \cos (-x) + i\sin(-x)
$$</p>
<p>olur. Kosinüs'ün simetrik davranışı, yani $\cos(-x)=\cos(x)$ ve
$-\sin(x)=\sin(-x)$ olması sebebiyle, üstteki </p>
<p>$$
= \cos(x) - i\sin(x)
$$</p>
<p>olarak yazılabilir. Şimdi eğer $e^{ix}$ ve $e^{-ix}$'i toplarsak, önceden
gördüğümüz açılımlar üzerinden,</p>
<p>$
e^{ix} + e^{-ix} = 2\cos(x)
$</p>
<p>olur, çünkü eksi işaretli $\sin$ artı olanla beraber iptal olur. Tekrar
düzenlersek,</p>
<p>$$
\cos(x) = \frac{1}{2} (e^{ix} + e^{-ix})
\qquad (3)
$$</p>
<p>Benzer bir eşitliği $e^{ix} - e^{-ix}$ üzerinden elde edebiliriz,</p>
<p>$$
e^{ix} - e^{-ix} = 2i\sin(x)
$$</p>
<p>Tekrar düzenleyince aynen biraz önce bir $\cos$ tanımı elde ettiğimiz gibi
bir de $\sin$ tanımı elde ederiz,</p>
<p>$$
\sin(x) = \frac{1}{2i} (e^{ix} - e^{-ix})
$$</p>
<p>Dalga kısmi denklemi ne idi?</p>
<p>$$
\partial_t^2 y(x,t) = c(x)^2 \partial_x^2 y(x,t)
$$</p>
<p>[2] notasyonu $c$ yerine $c(x)$ kullanmış. Şimdi stabilite şartını türetmek için
çözümün basit bir düzlem dalgası (plane wave) olduğunu farz edeceğiz [1], yani
çözüm</p>
<p>$$
y(x,t) = e^{i(kx-\omega t)}
$$</p>
<p>formunda olacak. Bu formu ayrıksallaştırıp kısmı türevsel forma sokunca çıkan
eşitlikler üzerinden bir stabilite şartı elde etmek amacımız. [3] notasyonu
yerine [2]'imsi notasyon kullanacağız, yani $x,t$ indisleri $i,j$ yerine $j,n$,
herhalde hayali sayı $i$ ile karışıklık olmasın diye böyle seçilmiş. O zaman $x
\to j \Delta x$, $t \to n \Delta t$ olur.</p>
<p>Alttaki analitik soldaki formül ayrıksal şu hale gelir,</p>
<p>$$
y(x,t) = e^{i(kx - \omega t)} \to
y_{j,n} = e^{i(kj\Delta x - \omega n \Delta t)}
$$</p>
<p>Peki bu formülleri (2) bağlamında nasıl kullanacağız? Aslında bu çok basit.</p>
<p>Mesela $y_{j+1,n}$ için ayrıksal uzayda bir adım atmış oluyoruz, bu adımın
basit dalga formülünde karşılığı</p>
<p>$$
y_{j+1,n} = e^{i ( k(j+1)\Delta x - \omega n \Delta t )}
$$</p>
<p>Karışık gibi duruyor fakat $e$ bazlı işlem yapmanın faydasını göreceğiz şimdi,</p>
<p>$$
= e^{i k \Delta x} e^{i(k j \Delta x - \omega n \Delta t)}
$$</p>
<p>Bir $e$ bazlı terimi dışarı çekmiş olduk. Geri kalan sağdaki $e$ bloğuna bakınca
onun $y_{j,n}$ olduğunu görüyoruz! O zaman </p>
<p>$$
y_{j+1,n} = e^{i k \Delta x} y_{j,n}
$$</p>
<p>Benzer bir işlemi $y_{j-1,n}$ için de gerçekleştirebiliriz, </p>
<p>$$
y_{j-1,n} = e^{-i k \Delta x} e^{i(k j \Delta x - \omega n \Delta t)}
$$</p>
<p>$$
 = e^{-i k \Delta x} y_{j,n}
$$</p>
<p>Teknik ayrıksal zaman üzerinde de işliyor,</p>
<p>$$
y_{j,n+1}  = e^{-i k \Delta t} y_{j,n}
$$</p>
<p>$$
y_{j,n-1}  = e^{i k \Delta t} y_{j,n}
$$</p>
<p>O zaman bu öğeleri dalga denklemi (2)'ye sokabiliriz. O denklemi [2]'ye göre
birazcık değiştirip tekrar verelim,</p>
<p>$$
\frac{y_{j,n+1} - 2 y_{j,n} + y_{j,n-1} }{\Delta t^2} =
c_j^2 \left[ \frac{ y_{j+1,n} - 2 y_{j,n} + y_{j-1,n} }{\Delta x^2}  \right]
$$</p>
<p>Şimdi üstteki formülde sonlu ayrıksal terimleri, yani $y_{j,n+1}$, $y_{j,n-1}$,
$y_{j+1,n}$, ve $y_{j-1,n}$ terimlerini, biraz önce bulduğumuz üstel terimlerle
değiştirelim,</p>
<p>$$
e^{i(k j \Delta x - \omega n \Delta t)} \left[
\frac{ e^{i\omega \Delta t} - 2  + e^{-i\omega \Delta t}  }
     {\Delta t^2}\right] =
c^2 \left[
\frac{e^{ik\Delta x} - 2 + e^{-ik\Delta x}}
     {\Delta x^2}
\right] e^{i(k j \Delta x - \omega n \Delta t)}
$$</p>
<p>$c_j \to c$ geçişi her $j \Delta x$ noktasına göre tanımlanıyor muhakkak.</p>
<p>Devam edelim, son formülde basitleştirme yapılabilir, en sol ve sağdaki terimler
iptal olabilir,</p>
<p>$$
\left[
\frac{ e^{i\omega \Delta t} - 2  + e^{-i\omega \Delta t}  }
     {\Delta t^2}\right] =
c^2 \left[
\frac{e^{ik\Delta x} - 2 + e^{-ik\Delta x}}
     {\Delta x^2}
\right]
$$</p>
<p>Geri kalanları tekrar düzenleyelim,</p>
<p>$$
e^{i\omega \Delta t} + e^{-i\omega \Delta t} - 2 =
c^2 \frac{\Delta t^2}{\Delta x^2} [ e^{ik\Delta x} - e^{-ik\Delta x} - 2]
$$</p>
<p>Hayali terimlerden kurtulmak istiyoruz tabii, bu noktada (3)'teki kosinüs
tanımını tekrar hatırlayalım, onu kullanırsak, eşitliğin solundaki iki terim ve
sağındaki iki terim için ayrı ayrı,</p>
<p>$$
2 \cos(\omega \Delta t) - 2 = c^2 \frac{\Delta t^2}{\Delta x^2}
(2 \cos(k\Delta x) - 2)
$$</p>
<p>Herşeyi 2 ile bölelim,</p>
<p>$$
\cos(\omega \Delta t) - 1 = c^2 \frac{\Delta t^2}{\Delta x^2}
(\cos(k\Delta x) - 1)
\qquad (4)
$$</p>
<p>Şimdi bir diğer trigonometrik eşitliği kullanacağız [4],</p>
<p>$$
2\sin^2(x) = 1 - \cos (2x)
$$</p>
<p>Biraz degistirirsek,</p>
<p>$$
\sin (x) = \sqrt{1 - \cos (2x)}
$$</p>
<p>Ya da</p>
<p>$$
\sin (\frac{x}{2}) = \pm \sqrt{1 - \cos (x)}
$$</p>
<p>Bu eşitliğin (4) ifadesini nasıl basitleştireceğini görmek zor değil,</p>
<p>$$
\sin^2(\omega \frac{\Delta t}{r}) =
c^2 \frac{\Delta t^2}{\Delta x^2} \sin^2 (k \frac{\Delta x}{2} )
$$</p>
<p>Karelerden kurtulabiliriz,</p>
<p>$$
\sin(\omega \frac{\Delta t}{r}) =
c \frac{\Delta t}{\Delta x} \sin (k \frac{\Delta x}{2} )
$$</p>
<p>İşte bu basit denklem sayısal analizin en temel bulgularından birine götürdü
bizi.</p>
<p>Üstteki denklemin reel sonuçlara sahip olması için</p>
<p>$$
c \frac{\Delta t}{\Delta x} \le 1
$$</p>
<p>olmalıdır. Bu koşul artık ünlü olan Courant-Friedrichs-Lewy (CFL) koşulu, ya da
kriteridir. Bu koşul iki tür hızın arasında bir ilişki kurar, biri fiziksel hız,
ki fiziksel ortamda dalganın yayılma hızı bu, diğeri ise "algoritmik hız" bir
anlamda, bizim tanımladığımız ızgaranın genişliği $\Delta x$ bölü yine bizim
seçtiğimiz zaman aralığı $\Delta t$.</p>
<pre><code class="python">rho = 0.01;
ten = 40.;
c = np.sqrt(ten/rho)               
c1 = c;
ratio =  c*c/(c1*c1)  # CFL kriteri = 1
# dongunun her adiminda sadece uc zaman dilimi yeterli, o sebeple
# xi [_,3] boyutunda. 
xi = np.zeros((101,3), float)                            
k = range(0,101)

for i in range(0, 81):
   xi[i, 0] = 0.00125*i         
for i in range (81, 101):
   xi[i, 0] = 0.1 - 0.005*(i - 80) 

fig = plt.figure()  
for i in range(1,100): 
    xi[i,1] = xi[i,0] + 0.5*ratio*(xi[i+1,0] + xi[i-1,0] -2*xi[i,0])  

for j in range(100):
   for i in range(1, 100):              
      xi[i,2] = 2.*xi[i,1]-xi[i,0]+ratio*(xi[i+1,1]+xi[i-1,1]-2*xi[i,1])
   if j % 5 == 0:      
      plt.grid(True)
      plt.xlim(0, 101)
      plt.ylim(-0.15, 0.15)
      plt.plot(k,xi[k,2])
      plt.savefig('/tmp/string-%02d.png' % j)
      plt.clf()
   # bitti, 1,2 indisi yeni 0,1 olacak
   for m in range (0,101):
      xi[m, 0] = xi[m, 1]
      xi[m, 1] = xi[m, 2]
</code></pre>

<p><img alt="" src="string-00.png" />
<img alt="" src="string-25.png" /></p>
<p><img alt="" src="string-55.png" />
<img alt="" src="string-85.png" /></p>
<pre><code class="python">! convert -loop 0 -delay 100 /tmp/string*.png string.gif
</code></pre>

<p>Animasyonlu sonucu [5]'te bulabiliriz.</p>
<p>Kaynaklar</p>
<p>[1] Bayramlı, <em>Fizik, Isı ve Dalga Denklemleri</em></p>
<p>[2] Igel, <em>Computers, Waves, Simulations, Coursera Lecture, Week 3, von Neumann Analysis</em>,
    <a href="https://www.coursera.org/learn/computers-waves-simulations">https://www.coursera.org/learn/computers-waves-simulations</a></p>
<p>[3] Landau, <em>Landau Computational Physics Course, Video Lectures</em>,
    <a href="https://www.youtube.com/playlist?list=PLnWQ_pnPVzmJnp794rQXIcwJIjwy7Nb2U">https://www.youtube.com/playlist?list=PLnWQ_pnPVzmJnp794rQXIcwJIjwy7Nb2U</a></p>
<p>[4] Bayramlı, <em>Diferansiyel Denklemler, Ekler, Trigonometri</em></p>
<p>[5] Bayramlı, <em>Animasyon</em>,
    <a href="https://raw.githubusercontent.com/burakbayramli/classnotes/master/compscieng/compscieng_app17wave/string.gif">https://raw.githubusercontent.com/burakbayramli/classnotes/master/compscieng/compscieng_app17wave/string.gif</a></p>
          <br/><a href="../index.html">Yukarı</a>
        </section>          
      </div>
    </body>
</html>
