
<!DOCTYPE html>
<html>
  <head>
    <title></title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {inlineMath: [["$","$"]]}
      });
    MathJax.Hub.Register.StartupHook("TeX Jax Ready",function () {
      MathJax.Hub.Insert(MathJax.InputJax.TeX.Definitions.macros,{
        cancel: ["Extension","cancel"],
        bcancel: ["Extension","cancel"],
        xcancel: ["Extension","cancel"],
        cancelto: ["Extension","cancel"]
      });
    });
    </script>
   <script type="text/javascript"
       src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML-full">
   </script>
   <script async="async" data-cfasync="false" src="//pl22489825.profitablegatecpm.com/d84f574876e65b2d8f0c7bae784c22b3/invoke.js"></script>

   <link rel="stylesheet" type="text/css" media="screen" href="https://burakbayramli.github.io/css/style.css">
  </head>
    <body>
      <div id="header_wrap" class="outer">
        <header class="inner">
          <h1 id="project_title">
            <a href="https://burakbayramli.github.io" style="text-decoration:none; color:inherit;">dersblog</a>
          </h1>
          <h2 id="project_tagline"></h2>          
        </header>
      </div>
      <div id="main_content_wrap" class="outer">        
        <section id="main_content" class="inner">
        <h1></h1>
<h1>Konuşma Tanıma (Speech Recognition)</h1>

<p>Frekans Üzerinden Özellik Çıkartımı, RNN, LSTM, GRU</p>

<p>1 saniyelik ses dosyaları var, bu dosyalardaki ses kayıtları dört farklı
komutu içeriyor, İngilizce up, down, yes, no (yukarı, aşağı, evet, hayır)
komutları. Ses kayıtları aslında zaman serileridir, tek boyutlu bir veri,
mesela 1 saniyelik 16,000 sayı içeren bir vektör. Örnek bir 'down' kaydının
neye benzediğini görelim,</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">util</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.io.wavfile</span><span class="o">,</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span><span class="o">,</span><span class="w"> </span><span class="nn">time</span><span class="o">,</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="w"> </span><span class="nn">random</span><span class="o">,</span><span class="w"> </span><span class="nn">re</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">train_dir</span> <span class="o">+</span> <span class="s1">&#39;/down/004ae714_nohash_0.wav&#39;</span>
<span class="n">wav</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">f</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">wav</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;speech_01.png&#39;</span><span class="p">)</span>
</code></pre>
</div>

<pre><code>train 8537 val 949
[-130 -135 -131 ..., -154 -190 -224]
</code></pre>

<p><img src="speech_01.png" alt="" /></p>

<p>Yapay öğrenme bağlamında zaman serileri için daha önce [7] yazısında LSTM
yapısını görmüştük. Örnek olarak zaman serilerini sınıfladık, zaman
serisindeki tüm veriler LSTM'e verilmişti, o zaman bir şeride 150 kusur
veri noktası varsa, o kadar LSTM hücresi yaratılacaktı. Fakat içinde
binlerce öğe olan seriler için bu iyi olmayabilir. Çözüm seriyi bir şekilde
özetleyerek bu daha az olan veriyi LSTM'e vermek. Bu özetlere ses işleme
alanında parmak izi (fingerprint) ismi de verilmekte.</p>

<p>Ses verilerini frekans üzerinden özetlemek bilinen bir teknik, ses verisi
ufak pencerelere bölünür, bu pencereler üzerinde Fourier transformu
işletilir, ve oradaki frekans bilgileri, hangi frekansın ne kadar önemli
olduğu elde edilir. Spektogram bu bilgiyi renkli olarak göstermenin bir
yolu, üstteki ses için,</p>

<div class="codehilite">
<pre><span></span><code><span class="n">plt</span><span class="o">.</span><span class="n">specgram</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;speech_02.png&#39;</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="speech_02.png" alt="" /></p>

<p>Spektogramın örüntü tanıma için kullanılabileceğini anlamak için bir tane
daha farklı 'down' sesi, bir de 'no' sesinin spektogramına bakalım,</p>

<div class="codehilite">
<pre><span></span><code><span class="n">f1</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">train_dir</span> <span class="o">+</span> <span class="s1">&#39;/down/0f3f64d5_nohash_2.wav&#39;</span>
<span class="n">wav1</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">f1</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">v1</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">wav1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">specgram</span><span class="p">(</span><span class="n">v1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;speech_03.png&#39;</span><span class="p">)</span>

<span class="n">f2</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">train_dir</span> <span class="o">+</span> <span class="s1">&#39;/no/01bb6a2a_nohash_0.wav&#39;</span>
<span class="n">wav2</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">f2</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
<span class="n">v2</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">wavfile</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">wav2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">specgram</span><span class="p">(</span><span class="n">v2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">Fs</span><span class="o">=</span><span class="n">util</span><span class="o">.</span><span class="n">fs</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;speech_04.png&#39;</span><span class="p">)</span>
</code></pre>
</div>

<p><img src="speech_03.png" alt="" />
<img src="speech_04.png" alt="" /></p>

<p>Görüyoruz ki 'down' seslerinin spektogramları birbirine benziyor. Öğrenme
için bu yapıyı kullanabiliriz. Bu arada spektogram "grafiği'' y-ekseninde
frekansları, x-ekseni zaman adımları gösterir, grafikleme kodu her zaman
penceresindeki belli frekans kuvvetlerinin hangi frekans kutucuğuna
düştüğüne bakar ve o kutucukta o kuvvete göre renklendirme yapar. Şimdi bu
grafikleme amaçlı, ama bazıları bu grafiğe bakarak "ben çıplak gözle bunu
tanıyabiliyorum, o zaman görsel tanımayla üstteki imajla sesi tanıyacak bir
DYSA kullanayım'' diye düşünebiliyor. Bu işleyen bir metot, zaten DYSA'nın
görsel tanıma tarihi eski, orada bilinen bir sürü teknik var. Her neyse
bazıları üstteki görsel spektogram grafiği, yani R,G,B kanallı çıktı
üzerinde görsel tanıma yapmayı da seçebiliyor, fakat bu şart değil, bir
spektogram, bir veri durumunda iki boyutlu bir matriste gösterilebilir.
TensorFlow ile bu hesabı örnek rasgele bir veri üzerinde yapalım,</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>

<span class="n">init_op</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16000</span><span class="p">])</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">stfts</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">frame_length</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span> 
                               <span class="n">frame_step</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="mi">512</span><span class="p">)</span>

<span class="n">spec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">stfts</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">spec</span><span class="p">)</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">16000</span><span class="p">)</span> <span class="c1"># rasgele bir zaman serisi uret</span>
<span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span> <span class="k">as</span> <span class="n">sess</span><span class="p">:</span>
     <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">())</span>
     <span class="n">res</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">spec</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="p">{</span><span class="n">data</span><span class="p">:</span> <span class="n">s</span> <span class="p">})</span>  
<span class="nb">print</span> <span class="p">(</span><span class="n">res</span><span class="p">)</span>
</code></pre>
</div>

<pre><code>Tensor("Placeholder_1:0", shape=(1, 16000), dtype=float32)
Tensor("Abs_1:0", shape=(1, 157, 257), dtype=float32)
[[[  99.39490509   65.10092163   12.84116936 ...,    5.39213753
      3.90902305    1.35875702]
  [ 100.60041809   66.32343292   12.92744541 ...,    4.64194965
      1.80256999    2.0458374 ]
  [ 104.70896149   70.13975525   15.93750095 ...,    3.21846962
      1.70909929    1.34316254]
  ..., 
  [  97.82588196   63.51060867   11.62135887 ...,    3.23712349
      1.94706416    0.41742325]
  [ 105.89834595   71.85715485   17.83632851 ...,    4.6476922
      2.42140603    1.37829971]
  [ 106.46664429   71.12073517   16.69457436 ...,    6.58148479
x      3.24354243    3.80913925]]]
</code></pre>

<p>Cok Katmanlı LSTM</p>

<p>LSTM, ya da diğer her RNN çeşidi çok katmanlı olarak kullanılabilir. </p>

<p><img src="stacked-rnn.png" alt="" /></p>

<p>Girdiler en alttaki LSTM hücrelerine geçiliyor, bu hücreler birbirlerine
konum aktarımı yaptıkları gibi bir sonraki LSTM katmanına girdi de 
sağlıyorlar, bu aktarım en üst tabakaya kadar gidiyor. Peki o zaman
sınıflama amaçlı olarak kullanılan "en son'' hücre hangisi olacaktır?
Bunun için tipik olarak katmanlı LSTM'de en üst ve en sondaki hücre
kullanılır. </p>

<p>Her hücrede 200 nöron var, o zaman her katman (124,200) boyutunda çünkü
spektogramdan 124 zaman boyutu geldi, ve LSTM'in en sondaki hücreden alınan
vektör 200 boyutunda olacak, bu çıktı bir tam bağlanmış (fully-connected)
katmana verilerek buradan 4 tane etiket için olasılık üretilecek, ve tahmin
için kullanılan sonuçlar bunlar olacak. O sayılardan en büyük olanı en
olası olan ses komutudur.</p>

<p>Tüm modeli görelim,</p>

<div class="codehilite">
<pre><span></span><code><span class="c1"># model_lstm.py</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span><span class="o">,</span><span class="w"> </span><span class="nn">util</span><span class="o">,</span><span class="w"> </span><span class="nn">os</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Model</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.pyc&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.py&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mfile</span> <span class="o">=</span> <span class="s2">&quot;/tmp/&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">+</span> <span class="s2">&quot;.ckpt&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">200</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dop_param</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1"># dropout olasiligi</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">num_cell</span> <span class="o">=</span> <span class="mi">200</span>

        <span class="n">tf</span><span class="o">.</span><span class="n">reset_default_graph</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dop</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span> <span class="c1"># dropout olasiligi (probability)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">util</span><span class="o">.</span><span class="n">fs</span><span class="p">])</span>

        <span class="nb">print</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stfts</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">stft</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">frame_length</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                                            <span class="n">frame_step</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">fft_length</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>

        <span class="nb">print</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stfts</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fingerprint</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stfts</span><span class="p">)</span>

        <span class="nb">print</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fingerprint</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">labels</span><span class="p">)])</span>
        <span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_layers</span><span class="p">):</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">rnn</span><span class="o">.</span><span class="n">LSTMCell</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_cell</span><span class="p">)</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">rnn</span><span class="o">.</span><span class="n">DropoutWrapper</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="n">output_keep_prob</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">dop</span><span class="p">)</span>
            <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">rnn</span><span class="o">.</span><span class="n">MultiRNNCell</span><span class="p">(</span><span class="n">cells</span><span class="p">)</span>
        <span class="n">output</span><span class="p">,</span> <span class="n">states</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">dynamic_rnn</span><span class="p">(</span><span class="n">cell</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fingerprint</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="nb">print</span> <span class="p">(</span><span class="n">output</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">states</span><span class="p">:</span> <span class="nb">print</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># en ust sagdaki son hucre</span>

        <span class="nb">print</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">last</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">logits</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">fully_connected</span><span class="p">(</span><span class="n">inputs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">last</span><span class="p">,</span>
                                                        <span class="n">num_outputs</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">labels</span><span class="p">),</span>
                                                        <span class="n">activation_fn</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

        <span class="nb">print</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logits</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">softmax</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax_cross_entropy_with_logits</span><span class="p">(</span><span class="n">logits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">logits</span><span class="p">,</span>
                                                               <span class="n">labels</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span> 

        <span class="bp">self</span><span class="o">.</span><span class="n">cross_entropy</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">softmax</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">train_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">AdamOptimizer</span><span class="p">(</span><span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">correct_prediction</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span>
                                           <span class="n">tf</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">logits</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">evaluation_step</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">correct_prediction</span><span class="p">,</span>
                                                      <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>


        <span class="bp">self</span><span class="o">.</span><span class="n">saver</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Saver</span><span class="p">()</span>


<span class="c1"># training 0.91 validation 0.926238</span>
</code></pre>
</div>

<p>Modelin girdi tensor'un boyutlarını nasıl değiştirdiği altta (üstteki resim
iki katman gösterdi, bizim modelde 4 katman var),</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">model_lstm</span>
<span class="n">m</span> <span class="o">=</span> <span class="n">model_lstm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>
</code></pre>
</div>

<pre><code>Tensor("Placeholder_1:0", shape=(?, 16000), dtype=float32)
Tensor("stft/rfft:0", shape=(?, 124, 129), dtype=complex64)
Tensor("Abs:0", shape=(?, 124, 129), dtype=float32)
Tensor("rnn/transpose:0", shape=(?, 124, 200), dtype=float32)
LSTMStateTuple(c=&lt;tf.Tensor 'rnn/while/Exit_2:0' shape=(?, 200) dtype=float32&gt;, h=&lt;tf.Tensor 'rnn/while/Exit_3:0' shape=(?, 200) dtype=float32&gt;)
LSTMStateTuple(c=&lt;tf.Tensor 'rnn/while/Exit_4:0' shape=(?, 200) dtype=float32&gt;, h=&lt;tf.Tensor 'rnn/while/Exit_5:0' shape=(?, 200) dtype=float32&gt;)
LSTMStateTuple(c=&lt;tf.Tensor 'rnn/while/Exit_6:0' shape=(?, 200) dtype=float32&gt;, h=&lt;tf.Tensor 'rnn/while/Exit_7:0' shape=(?, 200) dtype=float32&gt;)
LSTMStateTuple(c=&lt;tf.Tensor 'rnn/while/Exit_8:0' shape=(?, 200) dtype=float32&gt;, h=&lt;tf.Tensor 'rnn/while/Exit_9:0' shape=(?, 200) dtype=float32&gt;)
Tensor("rnn/while/Exit_8:0", shape=(?, 200), dtype=float32)
Tensor("fully_connected/BiasAdd:0", shape=(?, 4), dtype=float32)
</code></pre>

<p>Eğitim kodu,</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span><span class="o">,</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span><span class="o">,</span><span class="w"> </span><span class="nn">util</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.io.wavfile</span><span class="o">,</span><span class="w"> </span><span class="nn">zipfile</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">io</span><span class="o">,</span><span class="w"> </span><span class="nn">time</span><span class="o">,</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="w"> </span><span class="nn">random</span><span class="o">,</span><span class="w"> </span><span class="nn">re</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">model_lstm</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">model_lstm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span>

<span class="n">sess</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>

<span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">())</span>

<span class="n">saver</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Saver</span><span class="p">()</span>

<span class="c1"># eger model diskte varsa yukle</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">mfile</span><span class="p">)</span>
<span class="nb">print</span> <span class="s1">&#39;model file exists&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">mfile</span> <span class="o">+</span> <span class="s2">&quot;.index&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">mfile</span> <span class="o">+</span> <span class="s2">&quot;.index&quot;</span><span class="p">):</span>
     <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;restoring&#39;</span><span class="p">)</span>
     <span class="n">saver</span><span class="o">.</span><span class="n">restore</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mfile</span><span class="p">)</span>

<span class="n">train_files</span><span class="p">,</span> <span class="n">val_files</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">init_files</span><span class="p">()</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">num_epochs</span><span class="p">):</span>
    <span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_minibatch</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">train_files</span><span class="p">,</span> <span class="n">val_files</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">:</span><span class="n">train_x</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">:</span><span class="n">train_y</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">dop</span><span class="p">:</span><span class="n">m</span><span class="o">.</span><span class="n">dop_param</span><span class="p">}</span>
    <span class="n">acc</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">m</span><span class="o">.</span><span class="n">evaluation_step</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">train_step</span><span class="p">],</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;accuracy&#39;</span><span class="p">,</span> <span class="n">acc</span> <span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
         <span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">:</span><span class="n">train_x</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">:</span><span class="n">train_y</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">dop</span><span class="p">:</span><span class="n">m</span><span class="o">.</span><span class="n">dop_param</span> <span class="p">}</span>
         <span class="n">tacc</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">evaluation_step</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
     <span class="n">val_x</span><span class="p">,</span> <span class="n">val_y</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">get_minibatch</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">batch_size</span><span class="p">,</span><span class="n">train_files</span><span class="p">,</span> <span class="n">val_files</span><span class="p">,</span><span class="n">validation</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
         <span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">:</span><span class="n">val_x</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">y</span><span class="p">:</span><span class="n">val_y</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">dop</span><span class="p">:</span><span class="mi">0</span><span class="p">}</span>
         <span class="n">vacc</span> <span class="o">=</span> <span class="n">sess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">evaluation_step</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">d</span><span class="p">)</span>
         <span class="nb">print</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;training&#39;</span><span class="p">,</span> <span class="n">tacc</span><span class="p">,</span> <span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="n">vacc</span><span class="p">)</span>

<span class="c1"># modeli diske yaz</span>
<span class="n">saver</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">sess</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">mfile</span><span class="p">)</span>
</code></pre>
</div>

<p>Eğitim sonrası modelin başarısı eğitim verisi üzerinde yüzde 91, doğrulama
verisinde yüzde 92. Kullanılan veri [6]'da.</p>

<p>Dropout</p>

<p>TF ile katmanlararası her noktada dropout kullanılabilir. Dropout ile bir
katmandan çıkan ya da ona giren bağlantıların bir kısmı yoksayılır, ve
model elde kalanlar ile iş yapmaya uğraşır, aşırı uygunluk problemlerinden
böylece kaçınılmış olur. Üstteki kodda hangi olasılıkla dropout
yapılacağının olasılığı bir yer tutucu (placeholder) ile TF çizitinin
parçası haline getirildi, niye? Böylece son üründeki kullanımda bu
parametre 0 yapılarak hiç dropout yapılmaması sağlanabiliyor. Eğitim
sırasında bu değer 0.5, 0.2, vs yapılabilir, o zaman dropout devrede
olur. Gerçi biz eğitim sırasında da 0 ile eğittik, yani dropout
kullanmadık, ama lazım olduğu yerler olabilir, referans açısından burada
dursun.</p>

<p>Uygulama</p>

<p>Mikrofondan 1 saniyelik ses parçalarını alıp onu model üzerinde işletip
dört komuttan birini seçen örnek kod <code>mic.py</code>'da
bulunabilir. Performans gerçek zamanlı kullanım için yeterliydi, DYSA ufak
bir şey değil aslında, kaç parametre olduğuna bakalım,</p>

<div class="codehilite">
<pre><span></span><code><span class="nb">print</span> <span class="p">(</span><span class="n">util</span><span class="o">.</span><span class="n">network_parameters</span><span class="p">(),</span> <span class="s1">&#39;tane degisken var&#39;</span><span class="p">)</span>
</code></pre>
</div>

<pre><code>1227204 tane degisken var
</code></pre>

<p>1 milyon küsur parametreli bir DYSA , yani potansiyel olarak her saniye en
az bir milyon işlem yapılıyor demektir. Görünüşe göre hesap işliyor, TF
bazı optimizasyonlar yapmış belki, ve mikroişlemciler yeterince
hızlı. Teknoloji güzel şey.</p>

<p>CTC</p>

<p>Ses tanıma için bir diğer yaklaşım optik karakter tanıma yazısında görülen
CTC kullanımı [4,5]. Alttaki kodun kullandığı veri [1]'de, yaklaşımın
detayları [2]'de görülebilir. Bu ses verisi koca kelimeler, cümleleri
içeriyor, çok daha uzun veriler bunlar, ve kayıp fonksiyonu artık basit,
belli sayıda komut arasından seçim bazlı değil, büyük bir alfabeden gelen
öğelerin yanyana gelişini kontrol ediyor.</p>

<div class="codehilite">
<pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">python_speech_features</span><span class="w"> </span><span class="kn">import</span> <span class="n">mfcc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">tensorflow</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">tf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">glob</span><span class="w"> </span><span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">time</span><span class="o">,</span><span class="w"> </span><span class="nn">re</span><span class="o">,</span><span class="w"> </span><span class="nn">os</span><span class="o">,</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">librosa</span>

<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">num_hidden</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">num_layers</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_batches_per_epoch</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">sample_rate</span><span class="o">=</span><span class="mi">8000</span>
<span class="n">num_features</span> <span class="o">=</span> <span class="mi">13</span>
<span class="c1"># Accounting the 0th index +  space + blank label = 28 characters</span>
<span class="n">num_classes</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span>
<span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;num_classes </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">num_classes</span><span class="p">)</span>

<span class="n">SPACE_TOKEN</span> <span class="o">=</span> <span class="s1">&#39;&lt;space&gt;&#39;</span>
<span class="n">SPACE_INDEX</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">FIRST_INDEX</span> <span class="o">=</span> <span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># 0 is reserved to space</span>
<span class="n">mfile</span> <span class="o">=</span> <span class="s2">&quot;/tmp/speech.ckpt&quot;</span>

<span class="k">def</span><span class="w"> </span><span class="nf">convert_inputs_to_ctc_format</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span> <span class="n">fs</span><span class="p">,</span> <span class="n">target_text</span><span class="p">):</span>
    <span class="c1">#print(&#39;convert_inputs_to_ctc_format target_text:&#39; + target_text)</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">mfcc</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span> <span class="n">samplerate</span><span class="o">=</span><span class="n">fs</span><span class="p">,</span> <span class="n">numcep</span><span class="o">=</span><span class="n">num_features</span><span class="p">)</span>
    <span class="c1"># Transform in 3D array</span>
    <span class="n">train_inputs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">inputs</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:])</span>
    <span class="n">train_inputs</span> <span class="o">=</span> <span class="p">(</span><span class="n">train_inputs</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">train_inputs</span><span class="p">)</span>
    <span class="n">train_seq_len</span> <span class="o">=</span> <span class="p">[</span><span class="n">train_inputs</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1"># Get only the words between [a-z] and replace period for none</span>
    <span class="n">original</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">target_text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">))</span><span class="o">.</span>\
               <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span>\
               <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span>\
               <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span>\
               <span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span>\
               <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span>\
               <span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="c1">#print(&#39;original:&#39; + original)</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">original</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span><span class="p">)</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">targets</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="c1"># Adding blank label</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">([</span><span class="n">SPACE_TOKEN</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">])</span>

    <span class="c1"># Transform char into index</span>
    <span class="n">targets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">SPACE_INDEX</span> <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="n">SPACE_TOKEN</span> <span class="k">else</span> <span class="nb">ord</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">FIRST_INDEX</span>
                          <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">targets</span><span class="p">])</span>

    <span class="c1"># Creating sparse representation to feed the placeholder</span>
    <span class="n">train_targets</span> <span class="o">=</span> <span class="n">sparse_tuple_from</span><span class="p">([</span><span class="n">targets</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">train_seq_len</span><span class="p">,</span> <span class="n">original</span>


<span class="k">def</span><span class="w"> </span><span class="nf">sparse_tuple_from</span><span class="p">(</span><span class="n">sequences</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">):</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">seq</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sequences</span><span class="p">):</span>
        <span class="n">indices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">n</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">),</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seq</span><span class="p">))))</span>
        <span class="n">values</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span>

    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">sequences</span><span class="p">),</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="mi">0</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span>
                       <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">indices</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">shape</span>

<span class="k">def</span><span class="w"> </span><span class="nf">read_audio_from_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">):</span>
    <span class="n">audio</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">librosa</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sr</span><span class="o">=</span><span class="n">sample_rate</span><span class="p">,</span> <span class="n">mono</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">audio</span> <span class="o">=</span> <span class="n">audio</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">audio</span>

<span class="k">def</span><span class="w"> </span><span class="nf">find_files</span><span class="p">(</span><span class="n">directory</span><span class="p">,</span> <span class="n">pattern</span><span class="o">=</span><span class="s1">&#39;.wav&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Recursively finds all files matching the pattern.&quot;&quot;&quot;</span>
    <span class="n">files</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">directories</span><span class="p">,</span> <span class="n">filenames</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">directory</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span> 
            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span><span class="n">filename</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">pattern</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span> <span class="n">files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>    
    <span class="n">res</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_ctc</span><span class="p">():</span>
    <span class="n">graph</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
    <span class="k">with</span> <span class="n">graph</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
        <span class="c1"># e.g: log filter bank or MFCC features</span>
        <span class="c1"># Has size [batch_size, max_step_size, num_features], but the</span>
        <span class="c1"># batch_size and max_step_size can vary along each step</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">num_features</span><span class="p">])</span>

        <span class="c1"># Here we use sparse_placeholder that will generate a</span>
        <span class="c1"># SparseTensor required by ctc_loss op.</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">sparse_placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

        <span class="c1"># 1d array of size [batch_size]</span>
        <span class="n">seq_len</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">placeholder</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="p">[</span><span class="kc">None</span><span class="p">])</span>

        <span class="c1"># Defining the cell</span>
        <span class="c1"># Can be:</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">rnn</span><span class="o">.</span><span class="n">LSTMCell</span><span class="p">(</span><span class="n">num_hidden</span><span class="p">,</span> <span class="n">state_is_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Stacking rnn cells</span>
        <span class="n">stack</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">rnn</span><span class="o">.</span><span class="n">MultiRNNCell</span><span class="p">([</span><span class="n">cell</span><span class="p">]</span> <span class="o">*</span> <span class="n">num_layers</span><span class="p">,</span>
                                            <span class="n">state_is_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># The second output is the last state and we will no use that</span>
        <span class="n">outputs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">dynamic_rnn</span><span class="p">(</span><span class="n">stack</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

        <span class="n">shape</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="n">batch_s</span><span class="p">,</span> <span class="n">max_time_steps</span> <span class="o">=</span> <span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

        <span class="c1"># Reshaping to apply the same weights over the timesteps</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_hidden</span><span class="p">])</span>

        <span class="c1"># Truncated normal with mean 0 and stdev=0.1</span>
        <span class="c1"># Tip: Try another initialization</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">truncated_normal</span><span class="p">([</span><span class="n">num_hidden</span><span class="p">,</span>
                                             <span class="n">num_classes</span><span class="p">],</span>
                                            <span class="n">stddev</span><span class="o">=</span><span class="mf">0.1</span><span class="p">))</span>
        <span class="c1"># Zero initialization</span>
        <span class="c1"># Tip: Is tf.zeros_initializer the same?</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">constant</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">[</span><span class="n">num_classes</span><span class="p">]))</span>

        <span class="c1"># Doing the affine projection</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span> <span class="o">+</span> <span class="n">b</span>

        <span class="c1"># Reshaping back to the original shape</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="p">[</span><span class="n">batch_s</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_classes</span><span class="p">])</span>

        <span class="c1"># Time major</span>
        <span class="n">logits</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="n">loss</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ctc_loss</span><span class="p">(</span><span class="n">targets</span><span class="p">,</span> <span class="n">logits</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>
        <span class="n">cost</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>

        <span class="n">optimizer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">MomentumOptimizer</span><span class="p">(</span><span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span>
                                               <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">cost</span><span class="p">)</span>

        <span class="c1"># Option 2: tf.contrib.ctc.ctc_beam_search_decoder</span>
        <span class="c1"># (it&#39;s slower but you&#39;ll get better results)</span>
        <span class="n">decoded</span><span class="p">,</span> <span class="n">log_prob</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ctc_greedy_decoder</span><span class="p">(</span><span class="n">logits</span><span class="p">,</span> <span class="n">seq_len</span><span class="p">)</span>

        <span class="c1"># Inaccuracy: label error rate</span>
        <span class="n">ler</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">edit_distance</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">decoded</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int32</span><span class="p">),</span>
                                              <span class="n">targets</span><span class="p">))</span>

    <span class="n">files</span> <span class="o">=</span> <span class="n">find_files</span><span class="p">(</span><span class="s2">&quot;/home/burak/Downloads/vctk-p225-small/wav48/p225&quot;</span><span class="p">)</span>

    <span class="k">with</span> <span class="n">tf</span><span class="o">.</span><span class="n">Session</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="n">graph</span><span class="p">)</span> <span class="k">as</span> <span class="n">session</span><span class="p">:</span>

        <span class="n">tf</span><span class="o">.</span><span class="n">global_variables_initializer</span><span class="p">()</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

        <span class="n">saver</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Saver</span><span class="p">()</span>                

        <span class="k">for</span> <span class="n">curr_epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_epochs</span><span class="p">):</span>
            <span class="n">train_cost</span> <span class="o">=</span> <span class="n">train_ler</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_batches_per_epoch</span><span class="p">):</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
                <span class="n">txtfile</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;wav48&quot;</span><span class="p">,</span><span class="s2">&quot;txt&quot;</span><span class="p">)</span>
                <span class="n">txtfile</span> <span class="o">=</span> <span class="n">txtfile</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.wav&quot;</span><span class="p">,</span><span class="s2">&quot;.txt&quot;</span><span class="p">)</span>
                <span class="n">txt</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">txtfile</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">audio</span> <span class="o">=</span> <span class="n">read_audio_from_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">sample_rate</span><span class="p">)</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">convert_inputs_to_ctc_format</span><span class="p">(</span><span class="n">audio</span><span class="p">,</span><span class="n">sample_rate</span><span class="p">,</span><span class="n">txt</span><span class="p">)</span>
                <span class="n">train_inputs</span><span class="p">,</span> <span class="n">train_targets</span><span class="p">,</span> <span class="n">train_seq_len</span><span class="p">,</span> <span class="n">original</span> <span class="o">=</span> <span class="n">out</span>

                <span class="n">feed</span> <span class="o">=</span> <span class="p">{</span><span class="n">inputs</span><span class="p">:</span> <span class="n">train_inputs</span><span class="p">,</span>
                        <span class="n">targets</span><span class="p">:</span> <span class="n">train_targets</span><span class="p">,</span>
                        <span class="n">seq_len</span><span class="p">:</span> <span class="n">train_seq_len</span><span class="p">}</span>

                <span class="n">batch_cost</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="n">cost</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">],</span> <span class="n">feed</span><span class="p">)</span>
                <span class="n">train_ler</span> <span class="o">+=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">ler</span><span class="p">,</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">feed</span><span class="p">)</span>

                <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;batch_cost&#39;</span><span class="p">,</span> <span class="n">batch_cost</span><span class="p">,</span> <span class="s1">&#39;train_ler&#39;</span><span class="p">,</span> <span class="n">train_ler</span><span class="p">)</span>

            <span class="c1"># Decoding</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">decoded</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">feed_dict</span><span class="o">=</span><span class="n">feed</span><span class="p">)</span>
            <span class="n">str_decoded</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="n">FIRST_INDEX</span><span class="p">])</span>
            <span class="c1"># Replacing blank label to none</span>
            <span class="n">str_decoded</span> <span class="o">=</span> <span class="n">str_decoded</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="c1"># Replacing space label to space</span>
            <span class="n">str_decoded</span> <span class="o">=</span> <span class="n">str_decoded</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Original: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">original</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Decoded: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">str_decoded</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">curr_epoch</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">saver</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">session</span><span class="p">,</span> <span class="n">mfile</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">run_ctc</span><span class="p">()</span>
</code></pre>
</div>

<p>Kaynaklar</p>

<p>[1] Bayramlı, <em>VCTK Ses Tanima Verisi, Konusmaci 225</em>, <a href="https://drive.google.com/uc?export=view&id=1zK-mgG6Q8N8OuOGpexbxVkES3DuQhGOk">https://drive.google.com/uc?export=view&amp;id=1zK-mgG6Q8N8OuOGpexbxVkES3DuQhGOk</a></p>

<p>[2] Remy, <em>Application of Connectionist Temporal Classification (CTC) for Speech Recognition</em>,<a href="https://github.com/philipperemy/tensorflow-ctc-speech-recognition">https://github.com/philipperemy/tensorflow-ctc-speech-recognition</a></p>

<p>[3] Graves, <em>Supervised Sequence Labelling with Recurrent Neural Networks</em>, <a href="https://www.cs.toronto.edu/~graves/preprint.pdf">https://www.cs.toronto.edu/~graves/preprint.pdf</a></p>

<p>[4] Graves, <em>How to build a recognition system (Part 1): CTC Loss</em>, <a href="https://docs.google.com/presentation/d/1AyLOecmW1k9cIbfexOT3dwoUU-Uu5UqlJZ0w3cxilkI">https://docs.google.com/presentation/d/1AyLOecmW1k9cIbfexOT3dwoUU-Uu5UqlJZ0w3cxilkI</a></p>

<p>[5] Graves, <em>How to build a recognition system (Part 2): CTC Loss</em>, <a href="https://docs.google.com/presentation/d/12gYcPft9_4cxk2AD6Z6ZlJNa3wvZCW1ms31nhq51vMk">https://docs.google.com/presentation/d/12gYcPft9_4cxk2AD6Z6ZlJNa3wvZCW1ms31nhq51vMk</a></p>

<p>[6] Bayramlı, <em>Ses Komut Verisi</em>, <a href="https://drive.google.com/open?id=1BIGj3NtUZfSrXMaJ8hCqsz0UzS01MSrF">https://drive.google.com/open?id=1BIGj3NtUZfSrXMaJ8hCqsz0UzS01MSrF</a></p>

<p>[7] Bayramlı, Bilgisayar Bilim, <em>Uzun Kısa-Vade  Hafıza Ağları</em></p>

          <div id="container-d84f574876e65b2d8f0c7bae784c22b3"></div>

          <br/><a href="../index.html">Yukarı</a>
        </section>          
      </div>
    </body>
</html>
